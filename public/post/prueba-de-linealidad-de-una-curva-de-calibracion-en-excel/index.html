<!DOCTYPE html>
<html lang="es">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.69.0" />
  <meta name="author" content="Carlos Gómez">
  <meta name="description" content="Magíster en Estadística  
Químico - Bioquímico">

  
  
  
    
  
  
    
    
    <link rel="stylesheet" href="/css/highlight.min.css">
    
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.0/css/academicons.min.css" integrity="sha512-GGGNUPDhnG8LEAEDsjqYIQns+Gu8RBs4j5XGlxl7UfRaZBhCCm5jenJkeJL8uPuOXGqgl8/H1gjlWQDRjd3cUQ==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather%7CRoboto+Mono">
  <link rel="stylesheet" href="/css/hugo-academic.css">
  
  <link rel="stylesheet" href="/css/blue.css">
  

  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-103645009-1', 'auto');
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="//www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  

  <link rel="alternate" href="https://www.analytical.cl/index.xml" type="application/rss+xml" title="Carlos Gómez">
  <link rel="feed" href="https://www.analytical.cl/index.xml" type="application/rss+xml" title="Carlos Gómez">

  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/apple-touch-icon.png">

  <link rel="canonical" href="https://www.analytical.cl/post/prueba-de-linealidad-de-una-curva-de-calibracion-en-excel/">

  

  <title>Prueba de linealidad de una curva de calibración en Excel... Sí ¡En Excel! | Carlos Gómez</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Barra de navegación</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Carlos Gómez</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Blog</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#projects">
            
            <span>Proyectos</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#teaching">
            
            <span>Cursos</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#contact">
            
            <span>Contacto</span>
          </a>
        </li>

        
        

        
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  


  <div class="article-container">
    <h1 itemprop="name">Prueba de linealidad de una curva de calibración en Excel... Sí ¡En Excel!</h1>
    

<div class="article-metadata">

  <span class="article-date">
    <time datetime="2017-09-28 00:00:00 &#43;0000 UTC" itemprop="datePublished">
      Thu, Sep 28, 2017
    </time>
  </span>

  
  
  
  

  
  
  
  <span class="article-tags">
    <i class="fa fa-tags"></i>
    
    <a href="/tags/linealidad">linealidad</a
    >
    
  </span>
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fwww.analytical.cl%2fpost%2fprueba-de-linealidad-de-una-curva-de-calibracion-en-excel%2f"
         target="_blank">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Prueba%20de%20linealidad%20de%20una%20curva%20de%20calibraci%c3%b3n%20en%20Excel...%20S%c3%ad%20%c2%a1En%20Excel%21&amp;url=https%3a%2f%2fwww.analytical.cl%2fpost%2fprueba-de-linealidad-de-una-curva-de-calibracion-en-excel%2f"
         target="_blank">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.analytical.cl%2fpost%2fprueba-de-linealidad-de-una-curva-de-calibracion-en-excel%2f&amp;title=Prueba%20de%20linealidad%20de%20una%20curva%20de%20calibraci%c3%b3n%20en%20Excel...%20S%c3%ad%20%c2%a1En%20Excel%21"
         target="_blank">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=https%3a%2f%2fwww.analytical.cl%2fpost%2fprueba-de-linealidad-de-una-curva-de-calibracion-en-excel%2f&amp;title=Prueba%20de%20linealidad%20de%20una%20curva%20de%20calibraci%c3%b3n%20en%20Excel...%20S%c3%ad%20%c2%a1En%20Excel%21"
         target="_blank">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Prueba%20de%20linealidad%20de%20una%20curva%20de%20calibraci%c3%b3n%20en%20Excel...%20S%c3%ad%20%c2%a1En%20Excel%21&amp;body=https%3a%2f%2fwww.analytical.cl%2fpost%2fprueba-de-linealidad-de-una-curva-de-calibracion-en-excel%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>

    <div class="article-style" itemprop="articleBody">
      


<p>En un <a href="https://www.analytical.cl/post/como-demuestro-que-mi-curva-de-calibracion-es-lineal/">post anterior</a> vimos cómo evaluar la hipótesis de linealidad
de una curva de calibración. Propusimos dos tests estadísticos formales:</p>
<ol style="list-style-type: decimal">
<li>El test de Mandel (ISO 8466-1)</li>
<li>El test de carencia de ajuste (<em>lack-of-fit</em>) (ISO 11095)</li>
</ol>
<p>los cuáles nos permiten concluir (o no) que el modelo
lineal es <em>adecuado o razonable</em> para nuestros datos de calibración.
Nada más, ni nada menos. No cometa el error de afirmar que su calibración es
lineal, porque no existe método en el mundo que permita llegar a esa
conclusión.</p>
<p>Implementamos estos tests en lenguaje de programación <code>R</code> que es, actualmente,
la <em>lingua franca</em> de la estadística, big data, data science y toda esa
pirotecnia. Sin embargo, también es posible implementar fácilmente
estos tests en el viejo y querido, pero a veces vapuleado por la comunidad
Estadística, Excel. Obviamente,
no existe el comando <code>test.de.linealidad</code>, por lo tanto, tendremos que
“hacerlo a mano”.</p>
<p>En este post implementaremos el Test de Mandel, cuyos detalles puede
consultar <a href="https://www.analytical.cl/post/como-demuestro-que-mi-curva-de-calibracion-es-lineal/">aquí</a>. El test de carencia de ajuste lo veremos en otro post.</p>
<div id="test-de-mandel-en-excel" class="section level1">
<h1>Test de Mandel en Excel</h1>
<ol style="list-style-type: decimal">
<li>En primer lugar necesitaremos, obviamente, los datos de calibración.
Estos se muestran en Excel en la siguiente figura:</li>
</ol>
<p><img src="/img/datos.png" />
La gráfica de esta calibración se presenta a continuación. Note la
evidente no linealidad a alta concentración.</p>
<p><img src="/img/plot_cal.png" /></p>
<ol start="2" style="list-style-type: decimal">
<li><p>Bien, como Ud.recordará del post sobre <a href="https://www.analytical.cl/post/como-demuestro-que-mi-curva-de-calibracion-es-lineal/">linealidad</a>, para aplicar el test de Mandel debemos
ajustar dos modelos: un modelo lineal y otro no lineal. Mencionamos que para
darle sentido
químico-analítico ajustamos un modelo “no lineal” cuadrático. Yo sé que la
tentación
es grande para aplicar el botón derecho y <code>Ajustar línea de tendencia</code>, pero
mantengamos la calma. Lo haremos de otra forma.</p></li>
<li><p>Para ajustar un modelo cuadrático en Excel hay varias formas, pero en este
post utilizaremos las herramientas del menú <code>Análisis de datos</code>:</p></li>
</ol>
<p><img src="/img/tools.png" /></p>
<ol start="4" style="list-style-type: decimal">
<li>Como ajustaremos un modelo cuadrático, necesitamos incorporar la
variable <span class="math inline">\(X^2\)</span>. Esto es muy sencillo, debemos ubicarnos
en la columna B (donde está la <span class="math inline">\(Y\)</span>), presionar botón derecho y seleccionar
<code>Insertar</code>, lo cual generará una columna vacía entre <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> tal
como se muestra en la siguiente figura:</li>
</ol>
<p><img src="/img/insertar.png" />
A esta nueva columna la llamaremos <code>X^2</code>, y generaremos los valores
correspondientes en la celda <code>B2</code>con la fórmula <code>=A2^2</code>:</p>
<p><img src="/img/formula.png" /></p>
<p>Copiamos la fórmula hasta la celda <code>B12</code>:</p>
<p><img src="/img/copiada.png" /></p>
<ol start="5" style="list-style-type: decimal">
<li>Ahora ajustaremos el modelo cuadrático. Seleccionemos el menú <code>Datos</code> de
la cinta de herramientas, el cual mostrará a la derecha el menú
<code>Análisis de datos</code>, hacemos clic y se abrirá el siguiente cuadro:</li>
</ol>
<p><img src="/img/cuadro.png" /></p>
<p>Seleccionamos la opción <code>Regresión</code>, con lo que se abrirá el siguiente
diálogo:</p>
<p><img src="/img/regresion.png" /></p>
<p>En <code>Rango Y de entrada</code> presionamos la flecha negra que apunta hacia arriba
y seleccionamos con el <em>mouse</em> los datos de <span class="math inline">\(Y\)</span>, incluyendo la letra <span class="math inline">\(Y\)</span>,
luego presionamos la flecha que apunta hacia abajo:</p>
<p><img src="/img/rangoy.png" /></p>
<p>En <code>Rango X de entrada</code> presionamos la flecha negra que apunta hacia arriba
y seleccionamos con el <em>mouse</em> <strong>las dos columnas: <span class="math inline">\(X\)</span> y <span class="math inline">\(X^2\)</span></strong>,
incluyendo las etiquetas, luego presionamos la flecha que apunta hacia abajo:</p>
<p><img src="/img/rangox.png" /></p>
<p>Chequeamos los cuadritos <code>Rótulos</code>y <code>Nivel de confianza</code>.</p>
<p><div class="alert alert-warning">
  
Jamás chequee el cuadrito <code>Constante igual a cero</code>, a menos que haya
demostrado previamente esta hipótesis
</div>
</p>
<p>En <code>Opciones de salida</code> seleccionamos en <code>Rango de salida</code> la celda
<code>E1</code> (en realidad da igual, es para que tengamos la misma salida).</p>
<p><img src="/img/cuadrolisto.png" />
¡Listo! Por ahora no usaremos las otras opciones.</p>
<ol start="6" style="list-style-type: decimal">
<li>Presiones <code>Aceptar</code>y aparecerá el análisis estadístico a partir de la
celda <code>E1</code>:</li>
</ol>
<p><img src="/img/analisis.png" /></p>
<ol start="7" style="list-style-type: decimal">
<li>No nos detendremos a explicar toda la información estadística de
las tablas, iremos
directamente al grano: al test de linealidad de Mandel. Ubique en la tabla
inferior la fila de la variable <code>X^2</code> y la columna respectiva denominada
<code>Probabilidad</code>. En este ejemplo marqué con rojo la celda del test de Mandel:</li>
</ol>
<p><img src="/img/mandel.png" />
8. Esta celda representa el <em>p-value</em> del test de Mandel. En este ejemplo
el <em>p-value</em> = <span class="math inline">\(3,6\times 10^{-11}\)</span>, es decir,
bajo la interpretación tradicional
de las pruebas de hipótesis, ya que <em>p-value</em> <span class="math inline">\(&lt; 0,05\)</span>
concluiríamos que el modelo lineal no es adecuado o razonable para modelar
los datos de calibración.</p>
<p>Bueno, queridos lectores espero les haya gustado. Como siempre,
pueden dejar sus comentarios/críticas y sugerencias aquí abajo.
Hasta la próxima.</p>
</div>

    </div>
  </div>

</article>

<div class="container">
  <nav>
  <ul class="pager">
    
    <li class="previous"><a href="https://www.analytical.cl/post/validacion-calculos-incertidumbre-quimica-analitica-metodo-monte-carlo-parte2/"><span
      aria-hidden="true">&larr;</span> Validación de los cálculos de incertidumbre en química analítica con el método Monte Carlo. Parte II</a></li>
    

    
    <li class="next"><a href="https://www.analytical.cl/post/como-detectar-efecto-matriz-metodo-analitico/">¿Cómo detectar el efecto matriz en un método analítico? <span
      aria-hidden="true">&rarr;</span></a></li>
    
  </ul>
</nav>

</div>

<div class="article-container">
  
<section id="comments">
  <div id="disqus_thread">
    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "www-analytical-cl" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>
</section>


</div>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      © 2018 Carlos Gómez &middot; 

      Powered by the <a href="https://github.com/gcushen/hugo-academic" target="_blank">Academic
      theme</a> for <a href="http://gohugo.io" target="_blank">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js" integrity="sha512-jGsMH83oKe9asCpkOVkBnUrDDTp8wl+adkB2D+//JtlxO4SrLoJdhbOysIFQJloQFD+C4Fl1rMsQZF76JjV0eQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.2/imagesloaded.pkgd.min.js" integrity="sha512-iHzEu7GbSc705hE2skyH6/AlTpOfBmkx7nUqTLGzPYR+C1tRaItbRlJ7hT/D3YQ9SV0fqLKzp4XY9wKulTBGTw==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.1/TweenMax.min.js" integrity="sha512-Z5heTz36xTemt1TbtbfXtTq5lMfYnOkXM2/eWcTTiLU01+Sw4ku1i7vScDc8fWhrP2abz9GQzgKH5NGBLoYlAw==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.1/plugins/ScrollToPlugin.min.js" integrity="sha512-CDeU7pRtkPX6XJtF/gcFWlEwyaX7mcAp5sO3VIu/ylsdR74wEw4wmBpD5yYTrmMAiAboi9thyBUr1vXRPA7t0Q==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    
    <script src="/js/hugo-academic.js"></script>
    

    
    
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/languages/r.min.js"></script>
      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    <script src="//yihui.name/js/math-code.js"></script>
    <script async
    src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>

  </body>
</html>

