<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Carlos Gómez on Carlos Gómez</title>
    <link>https://www.analytical.cl/</link>
    <description>Recent content in Carlos Gómez on Carlos Gómez</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>es</language>
    <copyright>&amp;copy; 2017 Carlos Gómez</copyright>
    <lastBuildDate>Sun, 20 Aug 2017 00:00:00 +0000</lastBuildDate>
    <atom:link href="/" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Prueba de linealidad de una curva de calibración en Excel... Sí ¡En Excel!</title>
      <link>https://www.analytical.cl/post/prueba-de-linealidad-de-una-curva-de-calibracion-en-excel/</link>
      <pubDate>Thu, 28 Sep 2017 00:00:00 +0000</pubDate>
      
      <guid>https://www.analytical.cl/post/prueba-de-linealidad-de-una-curva-de-calibracion-en-excel/</guid>
      <description>&lt;p&gt;En un &lt;a href=&#34;https://www.analytical.cl/post/como-demuestro-que-mi-curva-de-calibracion-es-lineal/&#34;&gt;post anterior&lt;/a&gt; vimos cómo evaluar la hipótesis de linealidad de una curva de calibración. Propusimos dos tests estadísticos formales:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;El test de Mandel (ISO 8466-1)&lt;/li&gt;
&lt;li&gt;El test de carencia de ajuste (&lt;em&gt;lack-of-fit&lt;/em&gt;) (ISO 11095)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;los cuáles nos permiten concluir (o no) que el modelo lineal es &lt;em&gt;adecuado o razonable&lt;/em&gt; para nuestros datos de calibración. Nada más, ni nada menos. No cometa el error de afirmar que su calibración es lineal, porque no existe método en el mundo que permita llegar a esa conclusión.&lt;/p&gt;
&lt;p&gt;Implementamos estos tests en lenguaje de programación &lt;code&gt;R&lt;/code&gt; que es, actualmente, la &lt;em&gt;lingua franca&lt;/em&gt; de la estadística, big data, data science y toda esa pirotecnia. Sin embargo, también es posible implementar fácilmente estos tests en el viejo y querido, pero a veces vapuleado por la comunidad Estadística, Excel. Obviamente, no existe el comando &lt;code&gt;test.de.linealidad&lt;/code&gt;, por lo tanto, tendremos que “hacerlo a mano”.&lt;/p&gt;
&lt;p&gt;En este post implementaremos el Test de Mandel, cuyos detalles puede consultar &lt;a href=&#34;https://www.analytical.cl/post/como-demuestro-que-mi-curva-de-calibracion-es-lineal/&#34;&gt;aquí&lt;/a&gt;. El test de carencia de ajuste lo veremos en otro post.&lt;/p&gt;
&lt;div id=&#34;test-de-mandel-en-excel&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Test de Mandel en Excel&lt;/h1&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;En primer lugar necesitaremos, obviamente, los datos de calibración. Estos se muestran en Excel en la siguiente figura:&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;https://www.analytical.cl/img/datos.png&#34; /&gt; La gráfica de esta calibración se presenta a continuación. Note la evidente no linealidad a alta concentración.&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;https://www.analytical.cl/img/plot_cal.png&#34; /&gt;

&lt;/div&gt;
&lt;ol start=&#34;2&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;Bien, como Ud.recordará del post sobre &lt;a href=&#34;https://www.analytical.cl/post/como-demuestro-que-mi-curva-de-calibracion-es-lineal/&#34;&gt;linealidad&lt;/a&gt;, para aplicar el test de Mandel debemos ajustar dos modelos: un modelo lineal y otro no lineal. Mencionamos que para darle sentido químico-analítico ajustamos un modelo “no lineal” cuadrático. Yo sé que la tentación es grande para aplicar el botón derecho y &lt;code&gt;Ajustar línea de tendencia&lt;/code&gt;, pero mantengamos la calma. Lo haremos de otra forma.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Para ajustar un modelo cuadrático en Excel hay varias formas, pero en este post utilizaremos las herramientas del menú &lt;code&gt;Análisis de datos&lt;/code&gt;:&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;https://www.analytical.cl/img/tools.png&#34; /&gt;

&lt;/div&gt;
&lt;ol start=&#34;4&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Como ajustaremos un modelo cuadrático, necesitamos incorporar la variable &lt;span class=&#34;math inline&#34;&gt;\(X^2\)&lt;/span&gt;. Esto es muy sencillo, debemos ubicarnos en la columna B (donde está la &lt;span class=&#34;math inline&#34;&gt;\(Y\)&lt;/span&gt;), presionar botón derecho y seleccionar &lt;code&gt;Insertar&lt;/code&gt;, lo cual generará una columna vacía entre &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt; e &lt;span class=&#34;math inline&#34;&gt;\(Y\)&lt;/span&gt; tal como se muestra en la siguiente figura:&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;https://www.analytical.cl/img/insertar.png&#34; /&gt; A esta nueva columna la llamaremos &lt;code&gt;X^2&lt;/code&gt;, y generaremos los valores correspondientes en la celda &lt;code&gt;B2&lt;/code&gt;con la fórmula &lt;code&gt;=A2^2&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;https://www.analytical.cl/img/formula.png&#34; /&gt;

&lt;/div&gt;
&lt;p&gt;Copiamos la fórmula hasta la celda &lt;code&gt;B12&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;https://www.analytical.cl/img/copiada.png&#34; /&gt;

&lt;/div&gt;
&lt;ol start=&#34;5&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Ahora ajustaremos el modelo cuadrático. Seleccionemos el menú &lt;code&gt;Datos&lt;/code&gt; de la cinta de herramientas, el cual mostrará a la derecha el menú &lt;code&gt;Análisis de datos&lt;/code&gt;, hacemos clic y se abrirá el siguiente cuadro:&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;https://www.analytical.cl/img/cuadro.png&#34; /&gt;

&lt;/div&gt;
&lt;p&gt;Seleccionamos la opción &lt;code&gt;Regresión&lt;/code&gt;, con lo que se abrirá el siguiente diálogo:&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;https://www.analytical.cl/img/regresion.png&#34; /&gt;

&lt;/div&gt;
&lt;p&gt;En &lt;code&gt;Rango Y de entrada&lt;/code&gt; presionamos la flecha negra que apunta hacia arriba y seleccionamos con el &lt;em&gt;mouse&lt;/em&gt; los datos de &lt;span class=&#34;math inline&#34;&gt;\(Y\)&lt;/span&gt;, incluyendo la letra &lt;span class=&#34;math inline&#34;&gt;\(Y\)&lt;/span&gt;, luego presionamos la flecha que apunta hacia abajo:&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;https://www.analytical.cl/img/rangoy.png&#34; /&gt;

&lt;/div&gt;
&lt;p&gt;En &lt;code&gt;Rango X de entrada&lt;/code&gt; presionamos la flecha negra que apunta hacia arriba y seleccionamos con el &lt;em&gt;mouse&lt;/em&gt; &lt;strong&gt;las dos columnas: &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt; y &lt;span class=&#34;math inline&#34;&gt;\(X^2\)&lt;/span&gt;&lt;/strong&gt;, incluyendo las etiquetas, luego presionamos la flecha que apunta hacia abajo:&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;https://www.analytical.cl/img/rangox.png&#34; /&gt;

&lt;/div&gt;
&lt;p&gt;Chequeamos los cuadritos &lt;code&gt;Rótulos&lt;/code&gt;y &lt;code&gt;Nivel de confianza&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;alert alert-warning&#34;&gt;
  &lt;p&gt;Jamás chequee el cuadrito &lt;code&gt;Constante igual a cero&lt;/code&gt;, a menos que haya demostrado previamente esta hipótesis&lt;/p&gt;

&lt;/div&gt;

&lt;p&gt;En &lt;code&gt;Opciones de salida&lt;/code&gt; seleccionamos en &lt;code&gt;Rango de salida&lt;/code&gt; la celda &lt;code&gt;E1&lt;/code&gt; (en realidad da igual, es para que tengamos la misma salida).&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://www.analytical.cl/img/cuadrolisto.png&#34; /&gt; ¡Listo! Por ahora no usaremos las otras opciones.&lt;/p&gt;
&lt;ol start=&#34;6&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Presiones &lt;code&gt;Aceptar&lt;/code&gt;y aparecerá el análisis estadístico a partir de la celda &lt;code&gt;E1&lt;/code&gt;:&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;https://www.analytical.cl/img/analisis.png&#34; /&gt;

&lt;/div&gt;
&lt;ol start=&#34;7&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;No nos detendremos a explicar toda la información estadística de las tablas, iremos directamente al grano: al test de linealidad de Mandel. Ubique en la tabla inferior la fila de la variable &lt;code&gt;X^2&lt;/code&gt; y la columna respectiva denominada &lt;code&gt;Probabilidad&lt;/code&gt;. En este ejemplo marqué con rojo la celda del test de Mandel:&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;https://www.analytical.cl/img/mandel.png&#34; /&gt; 8. Esta celda representa el &lt;em&gt;p-value&lt;/em&gt; del test de Mandel. En este ejemplo el &lt;em&gt;p-value&lt;/em&gt; = &lt;span class=&#34;math inline&#34;&gt;\(3,6\times 10^{-11}\)&lt;/span&gt;, es decir, bajo la interpretación tradicional de las pruebas de hipótesis, ya que &lt;em&gt;p-value&lt;/em&gt; &lt;span class=&#34;math inline&#34;&gt;\(&amp;lt; 0,05\)&lt;/span&gt; concluiríamos que el modelo lineal no es adecuado o razonable para modelar los datos de calibración.&lt;/p&gt;
&lt;p&gt;Bueno, queridos lectores espero les haya gustado. Como siempre, pueden dejar sus comentarios/críticas y sugerencias aquí abajo. Hasta la próxima.&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Validación de los cálculos de incertidumbre en química analítica con el método Monte Carlo. Parte II</title>
      <link>https://www.analytical.cl/post/validacion-calculos-incertidumbre-quimica-analitica-metodo-monte-carlo-parte2/</link>
      <pubDate>Sat, 23 Sep 2017 00:00:00 +0000</pubDate>
      
      <guid>https://www.analytical.cl/post/validacion-calculos-incertidumbre-quimica-analitica-metodo-monte-carlo-parte2/</guid>
      <description>&lt;p&gt;En el &lt;a href=&#34;https://www.analytical.cl/post/validacion-calculos-incertidumbre-quimica-analitica-metodo-monte-carlo/&#34;&gt;post anterior&lt;/a&gt; describimos brevemente en qué consiste el método de Monte Carlo y cómo utilizarlo para estimar la incertidumbre de medición. Finalizamos comparando la estimación de acuerdo a la guía GUM con el método de Monte Carlo siguiendo estrictamente las directrices del test de diferencias numéricas propuesto por el Suplmento 1 de la GUM.&lt;/p&gt;
&lt;p&gt;Llevamos a cabo el test de validación “a mano”, es decir, ingresamos todas las instrucciones en código &lt;code&gt;R&lt;/code&gt;. Si bien no fue difícil, existen librerías especializadas en &lt;code&gt;R&lt;/code&gt; que permiten realizar todos los cálculos de incertidumbre y validarlos utilizando funciones ya incorporadas.&lt;/p&gt;
&lt;p&gt;En &lt;code&gt;R&lt;/code&gt;existen dos librerías especializadas en cálculo de incertidumbre de métodos de medición físico-químicos:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;metRology&lt;/code&gt; desarrollada en conjunto entre los Institutos Nacionales de Metrología del Reino Unido (LGC) y de Estados Unidos (NIST). Es mantenida por Steve Ellison, el autor de la guía GUM. Puede encontrar más información &lt;a href=&#34;https://www.nist.gov/programs-projects/metrology-software-project&#34;&gt;aquí&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;propagate&lt;/code&gt; desarrollada por Andrej-Nikolai Spiess&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Me inclinaré por &lt;code&gt;metRology&lt;/code&gt; principalmente porque tiene el soporte de los dos centros de metrología más imporantes a nivel mundial y, ya que fue desarrollada en sus inicios por Steve Ellison, tiene un pequeño sesgo hacia la metrología química.&lt;/p&gt;
&lt;div id=&#34;ejemplo-de-validacion-de-calculos-con-libreria-metrology&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Ejemplo de validación de cálculos con librería &lt;code&gt;metRology&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;Desarrollaremos un ejemplo más extenso sobre cálculo de incertidumbre en química analítica utilizando esta librería. Iremos paso a paso, cualquier duda en la implementación nada más escríbala en los comentarios más abajo. Sin embargo, no detallaremos cómo obtener las incertidumbres de cada uno de los factores involucrados en la ecuación de medición, sino que simplemente será un dato conocido para este ejemplo. En un futuro post, desarollaremos un ejemplo completo de principio a fin, por ahora nos centraremos en utilizar &lt;code&gt;metRology&lt;/code&gt;como herramienta práctica.&lt;/p&gt;
&lt;p&gt;En este ejemplo, calcularemos la incertidumbre de un método de determinación de cobre en mineral de cobre, con digestión ácida y cuantificación mediante espetroscopía de abosrción atómica AAS. Los detalles del método analítico están fuera del alcance de este post, pero pueden ser consultados en la norma chilena NCh 3392:2016.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Seguiremos estrictamente las directrices de la GUM, por lo tanto, queda fuera de esta evaluación cualquier corrección de sesgo y/o recuperación. La discusión sobre si se debiera, o no, incorporar el sesgo en la incertidumbre es un tema que abordaremos en otro post.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;El primer paso para estimar la incertidumbre de este método es escribir la ecuación de medición:&lt;/li&gt;
&lt;/ol&gt;
&lt;span class=&#34;math display&#34; id=&#34;eq:medicion&#34;&gt;\[\begin{equation}
  \text{Cu}[\text{%}]=\frac{\text{C}_{\text{calib}}\cdot V \cdot D}{m\cdot 10000}
  \tag{1}
\end{equation}\]&lt;/span&gt;
&lt;p&gt;donde &lt;span class=&#34;math inline&#34;&gt;\(\text{C}_{\text{calib}}\)&lt;/span&gt; es la concentración de la muestra digerida interpolada en la curva de calibración &lt;span class=&#34;math inline&#34;&gt;\([\mu\text{g}\,\text{mL}^{-1}]\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; es la masa de la muestra [g], &lt;span class=&#34;math inline&#34;&gt;\(V\,[\text{mL}]\)&lt;/span&gt; es el volumen del aforo final y &lt;span class=&#34;math inline&#34;&gt;\(D\)&lt;/span&gt; es un factor de dilución volumétrico, utilizado cuando es necesario. Para simplificar el problema, asumiremos que no hay dilución antes de la lectura por AAS, por lo tanto, &lt;span class=&#34;math inline&#34;&gt;\(D = 1\)&lt;/span&gt; y &lt;span class=&#34;math inline&#34;&gt;\(u_{D} = 0\)&lt;/span&gt;.&lt;/p&gt;
&lt;ol start=&#34;2&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Identificación de las fuentes de incertidumbre&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;A continuación se enumeran las fuentes de incertidumbre asociadas a cada uno de los factores de la ecuación &lt;a href=&#34;#eq:medicion&#34;&gt;(1)&lt;/a&gt; y se describe brevemente los métodos estadísticos y de juicio experto utilizados para obtener las incertidumbres estándar correpospondientes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(\text{C}_{\text{calib}}\)&lt;/span&gt;: La incertidumbre estándar de la concentración de una muestra problema &lt;span class=&#34;math inline&#34;&gt;\(u_{\text{C}_\text{calib}}\)&lt;/span&gt; obtenida de una curva de calibración lineal &lt;span class=&#34;math inline&#34;&gt;\(y = a + bx\)&lt;/span&gt; es calculada a partir de la siguiente expresión:&lt;/li&gt;
&lt;/ul&gt;
&lt;span class=&#34;math display&#34;&gt;\[\begin{equation}
u_{\text{C}_{\text{calib}}}=\frac{s_{y/x}}{b}\sqrt{\frac{1}{m}+\frac{1}{n}+
\frac{(C_{\text{calib}}-\overline{C})^2}{\sum(C_{i}-\overline{C})^2}}
\label{eq:ucurva}
\end{equation}\]&lt;/span&gt;
&lt;p&gt;donde &lt;span class=&#34;math inline&#34;&gt;\(s_{y/x}\)&lt;/span&gt; es la desviación estándar de la regresión, &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; es el número de replicados independientes de la muestra problema efectivamente analizados, &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; es el número de calibrantes, &lt;span class=&#34;math inline&#34;&gt;\(C_{\text{calib}}\)&lt;/span&gt; es la concentración de la muestra problema obtenida por interpolación en la curva de calibración, &lt;span class=&#34;math inline&#34;&gt;\(\overline{C}\)&lt;/span&gt; es el promedio de la concentraciones de los calibrantes. Estos parámetros pueden ser obtenidos directamente del análisis estadístico de la curva de calibración lineal. Cabe destacar que cuando se utiliza el método de mínimos cuadrados ordinarios para estimar la pendiente e intercepto de la curva, esta metodología no incorpora la incertirtumbre de la concentración de los calibrantes.&lt;/p&gt;
&lt;div class=&#34;alert alert-warning&#34;&gt;
  &lt;p&gt;Puede profundizar sobre la incertidumbre de calibración en el siguiente &lt;a href=&#34;https://www.analytical.cl/post/como-calcular-la-incertidumbre-de-una-curva-de-calibracion/&#34;&gt;post&lt;/a&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(V\)&lt;/span&gt;: La incertidumbre del volumen de aforo &lt;span class=&#34;math inline&#34;&gt;\(u_{\text{V}}\)&lt;/span&gt; es estimada a partir de la combinación de tres fuentes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(u_{\text{tol}}\)&lt;/span&gt; La incertidumbre informada por el fabricante en el certificado original del lote de producción o aquella impresa en el material de vidrio. Esta incertidumbre es de Tipo B.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(u_{\text{rep}}\)&lt;/span&gt; Incertidumbre debido a la repetibilidad de llenado del aforo del material de vidrio. Esta incertidumbre (Tipo A) es evaluada mediante métodos estadísticos a través de la replicación (&lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;) del llenado del material con agua destilada y el registro gravimétrico de la cantidad de agua. La incertidumbre estándar se expresa como la desviación estándar de los &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; replicados.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(u_{\text{temp}}\)&lt;/span&gt; La incertidumbre debido a la diferencia de temperatura registrada durante la calibración del material de vidrio y aquella que se registra durante los análisis de rutina. Esta incertidumbre expandida es expresada en la ecuación &lt;a href=&#34;#eq:uvol&#34;&gt;(2)&lt;/a&gt;:&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;span class=&#34;math display&#34; id=&#34;eq:uvol&#34;&gt;\[\begin{equation}
  U_{\text{temp}}= V\cdot \gamma_{\text{H}_{2}\text{O}} \cdot \Delta T
  \tag{2}
\end{equation}\]&lt;/span&gt;
&lt;p&gt;donde &lt;span class=&#34;math inline&#34;&gt;\(V\)&lt;/span&gt; es el volumen certificado del material de vidrio, &lt;span class=&#34;math inline&#34;&gt;\(\gamma_{\text{H}_{2}\text{O}} = 2.1\cdot 10^{-4}\,\text{°C}^{-1}\)&lt;/span&gt; es el coeficiente de expansión del agua y &lt;span class=&#34;math inline&#34;&gt;\(\Delta T\)&lt;/span&gt; es la variabilidad de la temperatura de trabajo del laboratorio en relación a la tempreratura de calibración del material. Finalmente, se obtiene asume una distribución rectangular de la variable  obteniéndose una incertidumbre estándar &lt;span class=&#34;math inline&#34;&gt;\(u_{\text{temp}}=U_{\text{temp}}/\sqrt{3}\)&lt;/span&gt; mL.&lt;/p&gt;
&lt;p&gt;Esta expresión debe utilizarse cuando exista un certificado de calibración que informe la temperatura de referencia registrada durante el proceso de certificación el cual puede provenir del mismo fabricante o de alguna institución metrológica nacional que certifique este tipo material. Generalmente la temperatura de calibración se espcifica a 20°C.&lt;/p&gt;
&lt;p&gt;La incertidumbre combinada estándar del volumen del aforo se obtiene a través de la siguiente expresión:&lt;/p&gt;
&lt;span class=&#34;math display&#34;&gt;\[\begin{equation}
u_{\text{V}} = \sqrt{u_{\text{tol}}^2+u_{\text{rep}}^2+u_{\text{temp}}^2} 
\end{equation}\]&lt;/span&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; : La incertidudmbre de la masa de la muestra es obtenida directamente del certificado de la balanza emitido por el nodo de metrología física nacional u otro proveedor de calibración.&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Cuantificación de los componentes de incertidumbre&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Como mencionamos anteriormente, no llevaremos a cabo la estimación de incertidumbre de cada uno de lo componentes, sino que asumiremos que estos datos ya están disponibles. Dedicaremos otro post a desarrollar un ejemplo completo de principio a fin.&lt;/p&gt;
&lt;ol start=&#34;4&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Cálculo de la incertidumbre combinada total&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Aplicando las directrices de la GUM y en base a la ecuación de medición &lt;a href=&#34;#eq:medicion&#34;&gt;(1)&lt;/a&gt;, la incertidumbre estándar de la concentración de Cu por este método analítico es obtenida a partir de:&lt;/p&gt;
&lt;span class=&#34;math display&#34; id=&#34;eq:ufinal&#34;&gt;\[\begin{equation}
u_{\text{Cu}} = \text{Cu}\sqrt{\left(\frac{u_{\text{C}_\text{calib}}}{\text{C}_{\text{calib}}}\right)^2+
\left(\frac{u_{\text{m}}}{m}\right)^2+
\left(\frac{u_{\text{V}}}{V}\right)^2}
\tag{3}
\end{equation}\]&lt;/span&gt;
&lt;p&gt;La tabla &lt;a href=&#34;#tab:udata&#34;&gt;1&lt;/a&gt; muestra las incertidumbres estándares de cada uno de los componentes de la ecuación &lt;a href=&#34;#eq:ufinal&#34;&gt;(3)&lt;/a&gt;:&lt;/p&gt;
&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
&lt;table class=&#34;table table-striped&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;caption&gt;
&lt;span id=&#34;tab:udata&#34;&gt;Table 1: &lt;/span&gt;Valores e incertidumbres estándar de cada componente
&lt;/caption&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Componente
&lt;/th&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Valor
&lt;/th&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
u
&lt;/th&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Unidades
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Concentracion calibracion
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
13.82
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.24
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
ug/mL
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Volumen aforo
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
250.00
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.14
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
mL
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Masa muestra
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.99160
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.00005
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
g
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Ok, vamos entonces a utilizar la librería &lt;code&gt;metRology&lt;/code&gt; para evaluar la incertidumbre del % de Cu.&lt;/p&gt;
&lt;div class=&#34;alert alert-warning&#34;&gt;
  &lt;p&gt;Debe, en primer lugar, instalar la librería mediante el comando &lt;code&gt;install.packages(&amp;lsquo;metRology&amp;rsquo;)&lt;/code&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;p&gt;Una vez instalada debe ingresar el siguiente código &lt;code&gt;R&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(metRology)  # Carga la librería metRology

# Ingresar los valores de cada variable input (Tabla 1)

Cu.calib &amp;lt;- 13.82 # Concentración interpolada en la curva de calibración [ug/mL]
V &amp;lt;- 250          # Volumen de aforo [mL]
m &amp;lt;- 0.9916       # Masa de la muestra [g]
D &amp;lt;- 1            # Factor de dilución (D = 1 implica no hay dilución)

# Ingresar las incertidumbres estándar de cada variable input (Tabla 1)
# Se mantienen, obviamente, las mismas unidades

u.Cu.calib &amp;lt;- 0.24
u.V &amp;lt;- 0.14
u.m &amp;lt;- 0.00005
u.D &amp;lt;- 0

# Ingresamos la ecuación de medición y la guardamos con el nombre C.Cu
# mediante el comando &amp;#39;expression&amp;#39;

C.Cu &amp;lt;- expression(Cu.calib*V*D/(m*10000))

# Guardemos en una lista los valores de cada variable input, la llamaremos
# x.Cu

x.Cu &amp;lt;- list(Cu.calib = Cu.calib, V = V , D = D, m = m)

# Guardemos en un vector las incertidumbres estándares de cada variable input
# ¡¡en el mismo orden que fueron ingresadas en x.Cu!!
# Llamaremos a este vector u.x.Cu

u.x.Cu &amp;lt;- c(u.Cu.calib, u.V, u.D, u.m)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;¡Estamos listos! Ahora &lt;code&gt;metRology&lt;/code&gt;hará todo el trabajo con el comando &lt;code&gt;uncert&lt;/code&gt;, Ud. debe elegir cuál método de estimación desea utilizar, las opciones son:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;GUM&lt;/li&gt;
&lt;li&gt;Monte Carlo&lt;/li&gt;
&lt;li&gt;Kragten: Método numérico basado en una aproximación de las derivadas parciales propuestas por GUM. Es una excelente alternativa y muy sencilla de implementar en Excel también.&lt;/li&gt;
&lt;li&gt;NUM y k2 son otras aproximaciones numéricas de derivadas parciales.&lt;/li&gt;
&lt;/ul&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Cálculo de incertidumbre de acuerdo a GUM:&lt;/li&gt;
&lt;/ol&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Ingresamos ¡en este orden! los siguientes parámetros del comando uncert
# Ecuación de medición C.Cu
# Lista de valores inputs x.Cu
# Vector de incertidumbres estándar u.x.Cu
# ¿Con cuál método quiere calcular la incertidumbre? En este caso GUM

u.Cu.GUM &amp;lt;- uncert(C.Cu, x.Cu, u.x.Cu, method = &amp;#39;GUM&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;La información que entrega &lt;code&gt;uncert&lt;/code&gt;es muy completa, sin embargo, para nuestro propósito sólo debemos fijarnos en el resultado que aparece al final del análisis, es decir: &lt;span class=&#34;math inline&#34;&gt;\(y = 0.3484268\)&lt;/span&gt; % Cu y &lt;span class=&#34;math inline&#34;&gt;\(u(y) = 0.006054\)&lt;/span&gt; % Cu.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;
Uncertainty evaluation

Call:
  uncert.expression(obj = C.Cu, x = x.Cu, u = u.x.Cu, method = &amp;quot;GUM&amp;quot;)

Expression: Cu.calib * V * D/(m * 10000)

Evaluation method:  GUM 

Uncertainty budget:
         x        u       c            u.c          
Cu.calib  13.8200 0.24000  0.025211779  6.050827e-03
V        250.0000 0.14000  0.001393707  1.951190e-04
D          1.0000 0.00000  0.348426785  0.000000e+00
m          0.9916 0.00005 -0.351378363 -1.756892e-05

   y:  0.3484268
u(y):  0.006053998 &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Además de los cálculos de incertidumbre, la opción &lt;code&gt;method = &#39;GUM&#39;&lt;/code&gt; entrega 4 gráficos muy interesantes, siendo el más importante el de &lt;em&gt;Contribuciones combinadas&lt;/em&gt;, el cual se muestra en la figura &lt;a href=&#34;#fig:plotGUM&#34;&gt;1&lt;/a&gt;. En este gráfico queda en evidencia que el factor que más aporta a la incertidumbre total (evaluada por GUM) es la curva de calibración.&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:plotGUM&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/2017-09-23-validacion-de-los-calculos-de-incertidumbre-en-quimica-analitica-con-el-metodo-monte-carlo-parte2_files/figure-html/plotGUM-1.png&#34; alt=&#34;Gráfico de contribución a la incertidumbre total&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 1: Gráfico de contribución a la incertidumbre total
&lt;/p&gt;
&lt;/div&gt;
&lt;ol start=&#34;2&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Cálculo de incertidumbre de acuerdo a Monte Carlo:&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Esencialmente es el mismo comando que utilizamos para GUM, sólo que seleccionaremos &lt;code&gt;method = &#39;MC&#39;&lt;/code&gt;. Sin embargo, este método tiene varias opciones adicionales muy interesantes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Con la opción &lt;code&gt;distrib&lt;/code&gt; Ud. puede asignar a cada variable su respectiva distribución de probabilidad: Normal, uniforme, triangular o Student. Por defecto, asume que todas son normales.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Con la opción &lt;code&gt;B&lt;/code&gt; indica el número de simulaciones. Por defecto &lt;code&gt;B = 200&lt;/code&gt;. Le sugiero cambiar a &lt;code&gt;B = 10000&lt;/code&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Guardaremos los cálculos en el objeto u.Cu.MC

set.seed(123) # Sólo para que Ud. obtenga los mismos resultados

u.Cu.MC &amp;lt;- uncert(C.Cu, x.Cu, u.x.Cu, method = &amp;#39;MC&amp;#39;, B = 10000)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;El método de Monte Carlo entrega el siguiente análisis:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;
Uncertainty evaluation

Call:
  uncert.expression(obj = C.Cu, x = x.Cu, u = u.x.Cu, method = &amp;quot;MC&amp;quot;,     B = 10000)

Expression: Cu.calib * V * D/(m * 10000)

Evaluation method:  MC 

Budget:
         x        u       c            u.c           distrib
Cu.calib  13.8200 0.24000  0.025211842  6.050842e-03 norm   
V        250.0000 0.14000  0.001393355  1.950696e-04 norm   
D          1.0000 0.00000           NA            NA norm   
m          0.9916 0.00005 -0.351680471 -1.758402e-05 norm   
         distrib.pars         
Cu.calib mean=13.82, sd=0.24  
V        mean=250, sd=0.14    
D        mean=1, sd=0         
m        mean=0.9916, sd=5e-05

   y:  0.3484268
u(y):  0.006046603 

Monte Carlo evaluation using 10000 replicates:

   y:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.3252  0.3444  0.3484  0.3484  0.3525  0.3720 &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;El MMC obtiene &lt;span class=&#34;math inline&#34;&gt;\(y = 0.3484268\)&lt;/span&gt; % Cu y &lt;span class=&#34;math inline&#34;&gt;\(u(y) = 0.0060466\)&lt;/span&gt; % Cu.&lt;/p&gt;
&lt;p&gt;La tabla &lt;a href=&#34;#tab:comparacion&#34;&gt;2&lt;/a&gt; muestra la comparación de ambas aproximaciones en la estimación de la incertidumbre estándar:&lt;/p&gt;
&lt;table&gt;
&lt;caption&gt;
&lt;span id=&#34;tab:comparacion&#34;&gt;Table 2: &lt;/span&gt;Cuadro comparativo GUM v/s Monte Carlo % Cu
&lt;/caption&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Método
&lt;/th&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Valor calculado
&lt;/th&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
u
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
GUM
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.3484268
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.0060540
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Monte Carlo
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.3484268
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.0060466
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Note la excelente concordancia entre ambas metodologías &lt;strong&gt;para esta ecuación de medición asumiendo una distribución normal para todas las variables inputs&lt;/strong&gt;. En este caso, &lt;em&gt;muy particular&lt;/em&gt;, casi sería innecesario validar el método GUM, pero lo haremos de todas maneras para ejemplificar la operación.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;validacion-de-los-calculos-gum-con-el-metodo-de-monte-carlo&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Validación de los cálculos GUM con el método de Monte Carlo&lt;/h2&gt;
&lt;p&gt;En el &lt;a href=&#34;https://www.analytical.cl/post/validacion-calculos-incertidumbre-quimica-analitica-metodo-monte-carlo/&#34;&gt;post anterior&lt;/a&gt; hicimos el test de validación numérica “a mano”, en esta oportunidad utilizaremos el comando &lt;code&gt;GUM.validate&lt;/code&gt;. Lamentablemente este comando tiene una forma distinta de ingresar los parámetros, nada del otro mundo, pero es distinta a &lt;code&gt;uncert&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Si bien GUM.validate tiene muchas opciones, utilizaremos aquellas
# que están por defecto en la librería

# Guarde en un vector el nombre de las variables, cada una entre &amp;#39; &amp;#39;
variables &amp;lt;- c(&amp;#39;Cu.calib&amp;#39;, &amp;#39;V&amp;#39;, &amp;#39;D&amp;#39;, &amp;#39;m&amp;#39;)

# Guarde en un vector x.i los valores de la variables input en el 
# mismo orden que ingresó &amp;#39;variables&amp;#39; arriba
x.i &amp;lt;- c(13.82, 250, 1, 0.9916)

# Guarde en un vector u.i las incertidumbres estándar de las variables
# input, en el mismo orden que ingresó &amp;#39;variables&amp;#39; arriba
u.i &amp;lt;- c(0.24, 0.14, 0, 0.00005)

# Guarde los grados de libertad de cada variable input como nu.i. 
# En este ejemplo  asumiremos que todas tienen infinitos grados de 
# libertad (nu = 9999)

nu.i &amp;lt;- c(9999, 9999, 9999, 9999)

# Seleccione que tipo de método utilizó para evaluar cada una de las
# incertidumbres: Tipo A o tipo B. En este caso sólo la incertidumbre
# de calibración u.Cu.calib es de tipo A.

type &amp;lt;- c(&amp;#39;A&amp;#39;, &amp;#39;B&amp;#39;, &amp;#39;B&amp;#39;, &amp;#39;B&amp;#39;)

# Seleccione que distribuciones de probabilidad asignó a las variables
# input. En este ejemplo, asumiremos que todas son normales

distribution &amp;lt;- rep(&amp;#39;Normal&amp;#39;, 4) # Repetir Normal 4 veces (soy muy flojo)

# Guarde la ecuación de medición entre &amp;#39;&amp;#39;
ec_de_medicion &amp;lt;- &amp;#39;Cu.calib*V*D/(m*10000)&amp;#39;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Listo, ahora validemos los cálculos GUM con el comando &lt;code&gt;GUM.validate&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;set.seed(126) # Tu ya sabes
GUM.validate(var.name = variables, 
             x.i = x.i,
             u.i = u.i,
             nu.i = nu.i,
             type = type,
             distribution = distribution,
             measurement.fnc = ec_de_medicion)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;[1] 0.958&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;“Bueno ¿Y?” se preguntará Ud.&lt;/p&gt;
&lt;p&gt;Bien, para validar el método GUM frente a Monte Carlo, fíjese en el valor que entrega &lt;code&gt;GUM.validate = 0.958&lt;/code&gt; y compárelo con 0.95. Si el valor de &lt;code&gt;GUM.validate&lt;/code&gt; &lt;span class=&#34;math inline&#34;&gt;\(&amp;gt; 0.95\)&lt;/span&gt; entonces el método GUM queda validado.&lt;/p&gt;
&lt;p&gt;En el fondo, &lt;code&gt;GUM.validate&lt;/code&gt; evalúa si el intervalo de incertidumbre calculado por GUM alcanza o no la cobertura esperada del 95% (teórica).&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;resumiendo&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Resumiendo&lt;/h2&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;El método de Monte Carlo funciona en casos donde las suposiciones del método GUM no se cumplen, especialmente en ecuaciones de medición no lineales.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Mientras más divergencia de la linealidad tenga el modelo de medición, más discrepancias habrá entre ambos métodos.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Es posible que cuando incorpore distribuciones rectangulares (uniformes), el histograma de los valores de Monte Carlo esté dominado por este tipo de distribuciones. Verá un achatamiento del histograma.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Ya hablamos que la pureza química (al menos para compuestos muy puros &lt;span class=&#34;math inline&#34;&gt;\(&amp;gt; 95\%\)&lt;/span&gt;) no es correcto modelarla mediante una distribución Normal (¿&lt;span class=&#34;math inline&#34;&gt;\(99.7 \pm 0.5\)&lt;/span&gt; %?), sino con una Beta. Lamentablmente, la librería &lt;code&gt;metRology&lt;/code&gt;no posee esta distribución en sus opciones y tendrá que hacer la simulación “a mano”.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;En general para distribuciones de Monte Carlos muy asimétricas (como la pureza química modelada con Beta), la diferencia entre MC y GUM se verá reflejada en la incertidumbre expandida y no en la estándar.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Quedan muchas cosas por analizar del método de Monte Carlo, sin embargo, el espíritu de este post es divulgar a la comunidad químico-analítica esta poderosa herramienta más que entrar en los detalles teóricos.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Usamos el lenguaje &lt;code&gt;R&lt;/code&gt;porque es actualmente el &lt;em&gt;idioma oficial&lt;/em&gt; de la estadística. Sin embargo, Ud. puede implementar estos cálculos en cualquier lenguaje e incluso en Excel. Además, existen muchos otros softwares que, aunque no tan flexibles y potentes como &lt;code&gt;R&lt;/code&gt;, harán el trabajo. Revise la siguiente lista en &lt;a href=&#34;https://en.wikipedia.org/wiki/List_of_uncertainty_propagation_software&#34;&gt;Wikipedia&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Espero que este post haya sido de su agrado, todos los comentarios son bienvenidos. Hasta la próxima.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;bibliografia&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Bibliografía&lt;/h2&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;Evaluation of measurement data – Guide to the expression of uncertainty in measurement JCGM 100:2008&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Evaluation of measurement data – Supplement 1 to the “Guide to the expression of uncertainty in measurement” – Propagation of distributions using a Monte Carlo method JCGM 101:2008&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Stephen L R Ellison &lt;em&gt;metRology: Support for Metrological Applications&lt;/em&gt; R package version 0.9-23-2, 2016.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Validación de los cálculos de incertidumbre en química analítica con el método Monte Carlo. Parte I</title>
      <link>https://www.analytical.cl/post/validacion-calculos-incertidumbre-quimica-analitica-metodo-monte-carlo/</link>
      <pubDate>Wed, 20 Sep 2017 00:00:00 +0000</pubDate>
      
      <guid>https://www.analytical.cl/post/validacion-calculos-incertidumbre-quimica-analitica-metodo-monte-carlo/</guid>
      <description>&lt;p&gt;De acuerdo al numeral 8.1 del Suplemento 1 de la guía GUM, el método de Monte Carlo es un método general para estimar la incertidumbre de medición y puede, bajo ciertas directrices, validar los cálculos realizados con el método GUM. En este post asumiremos que Ud., esimado lector, está familiarizado con el método GUM y ya lo tiene implementado , por ejemplo, en una hoja Excel y le gustaría validar sus cálculos mediante un método totalmente independiente y más general. De esta forma podrá cumplir cabalmente con el siguiente numeral de la norma 17025:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;5.4.7.1 Los cálculos y la transferencia de los datos deben estar sujetos a verificaciones adecuadas llevadas a cabo de una manera sistemática.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;¿Cómo sabe Ud. que su implementación en Excel está correcta?&lt;/p&gt;
&lt;div id=&#34;que-es-el-metodo-de-monte-carlo&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;¿Qué es el método de Monte Carlo?&lt;/h1&gt;
&lt;p&gt;(Aquí podría hacer copy-paste de Wikipedia…no olvidar borrar esta nota interna)&lt;/p&gt;
&lt;p&gt;Muy sucintamente, el método de Monte Carlo es un método numérico que permite evaluar expresiones matemáticas complejas (muy complejas, créame) mediante la simulación de números aleatorios. Este post no pretende profundizar en la teoría de este método (ZzzZzz…) , sino más bien dar ejemplos concretos aplicados en química analítica, por lo tanto, es posible que un avezado estadístico computacional le dé un infarto al leer la soltura con la cual me expreso y lo ineficiente del código &lt;code&gt;R&lt;/code&gt;. El objetivo es simplemente la divulgación a la comunidad químico-analítica para abordar algunos puntos normativos de la 17025 y guía GUM.&lt;/p&gt;
&lt;p&gt;Veamos un ejemplo sencillo. Supongamos que necesitamos calcular la incertidumbre de la suma de 2 variables aleatorias normales &lt;strong&gt;independientes&lt;/strong&gt;, y que poseen&lt;br /&gt;
la misma media (&lt;span class=&#34;math inline&#34;&gt;\(\mu\)&lt;/span&gt;) y varianza (&lt;span class=&#34;math inline&#34;&gt;\(\sigma^2\)&lt;/span&gt;), es decir, si &lt;span class=&#34;math inline&#34;&gt;\(Z = X + Y\)&lt;/span&gt; ¿Cuál es la incertiumbre de &lt;span class=&#34;math inline&#34;&gt;\(Z\)&lt;/span&gt;? (&lt;span class=&#34;math inline&#34;&gt;\(u_{Z}\)&lt;/span&gt;)&lt;/p&gt;
&lt;p&gt;Si Ud. recuerda de sus cursos de probabilidades, este problema tiene una solución directa y sencilla:&lt;/p&gt;
&lt;span class=&#34;math display&#34;&gt;\[\begin{eqnarray}
  V(Z) &amp;amp;=&amp;amp; V(X) + V(Y) \\
  V(Z) &amp;amp;=&amp;amp; \sigma^2 + \sigma^2 \\
  V(Z) &amp;amp;=&amp;amp; 2\sigma^2
\end{eqnarray}\]&lt;/span&gt;
&lt;p&gt;donde &lt;span class=&#34;math inline&#34;&gt;\(V()\)&lt;/span&gt; denota varianza. Por lo tanto, la incertidumbre de Z es &lt;span class=&#34;math inline&#34;&gt;\(u_{Z} = \sqrt{V(Z)} = \sqrt{2}\sigma\)&lt;/span&gt;. Si Ud, conoce &lt;span class=&#34;math inline&#34;&gt;\(\sigma\)&lt;/span&gt;, es decir, la incertidumbre estándar de &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt; e &lt;span class=&#34;math inline&#34;&gt;\(Y\)&lt;/span&gt;, el problema está resuelto. En realidad, este ejemplo es bastente general y las distribuciones ni siquiera tienen que ser las mismas, bajo ciertas condiciones, esto se cumplirá.&lt;/p&gt;
&lt;p&gt;Pero supongamos que, repentinamente, Ud. olvidó todo lo aprendido en esas estimulantes clases de probabilidades con 33°C y sin aire acondicionado. No se preocupe, obtendremos la incertidumbre de Z sin recurrir a ninguna propiedad teórica de las varianzas. Usareemos el método de Monte Carlo, para lo cual debemos hacer lo siguiente:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;Asigne a cada variable, en este caso &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt; e &lt;span class=&#34;math inline&#34;&gt;\(Y\)&lt;/span&gt;, una distribución de probabilidad de acuerdo a la información que disponga hasta ese momento. En nuestro ejemplo tanto &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt; como &lt;span class=&#34;math inline&#34;&gt;\(Y\)&lt;/span&gt; son normales con la misma media (&lt;span class=&#34;math inline&#34;&gt;\(\mu\)&lt;/span&gt;) y desviación estándar (&lt;span class=&#34;math inline&#34;&gt;\(\sigma\)&lt;/span&gt;). Sin pérdida de generalidad, diremos que ambas variables &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt; e &lt;span class=&#34;math inline&#34;&gt;\(Y\)&lt;/span&gt; son normales con media &lt;span class=&#34;math inline&#34;&gt;\(\mu = 100\)&lt;/span&gt; y desviación estándar &lt;span class=&#34;math inline&#34;&gt;\(\sigma = 5\)&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;De cada variable genere un valor aleatorio. Es decir, en nuestro ejemplo debemos generar un número aleatorio para &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt; y otro para &lt;span class=&#34;math inline&#34;&gt;\(Y\)&lt;/span&gt; a partir de sus respectivas distribuciones de probabilidad asignadas, que en este caso es la misma. Haremos esto en lenguaje &lt;code&gt;R&lt;/code&gt;:&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Generamos n = 1 número aletorio para X a partir de una
# distribución Normal con media 100 y desviación estándar 5
X &amp;lt;- rnorm(1, 100, 5) 

# Generamos n = 1 número aletorio para Y a partir de una
# distribución Normal con media 100 y desviación estándar 5
Y &amp;lt;- rnorm(1, 100, 5) &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;En esta primera simulación obtuvimos &lt;span class=&#34;math inline&#34;&gt;\(X = 97.1976218\)&lt;/span&gt; e &lt;span class=&#34;math inline&#34;&gt;\(Y = 98.8491126\)&lt;/span&gt;.&lt;/p&gt;
&lt;ol start=&#34;3&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;Calcule la variable de interés con los datos simulados. En el ejemplo, &lt;span class=&#34;math inline&#34;&gt;\(Z = X + Y = 97.1976218 + 98.8491126= 196.0467343\)&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Repita los pasos 2 y 3 &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; veces y obtenga la distribución empírica de &lt;span class=&#34;math inline&#34;&gt;\(Z\)&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;A partir de los &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; datos simulados de &lt;span class=&#34;math inline&#34;&gt;\(Z\)&lt;/span&gt;, estime &lt;span class=&#34;math inline&#34;&gt;\(u_{Z} = s_{Z}\)&lt;/span&gt;, es decir, la desviación estándar muestral de los &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; datos.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Hay varias formas de implementar todos estos pasos en &lt;code&gt;R&lt;/code&gt;, la más intuitiva (creo yo) es la siguiente:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;n &amp;lt;- 1000 # Obtendremos n = 1000 datos aleatorios para X e Y
mu &amp;lt;- 100 # Media mu = 100
s &amp;lt;- 5    # Desviación estandar s = 5

X &amp;lt;- rnorm(n, mu, s) # 1000 datos aleatorios de una normal con parámetros mu y s
Y &amp;lt;- rnorm(n, mu, s) # 1000 datos aleatorios de una normal con parámetros mu y s

Z &amp;lt;- X + Y # Para cada uno de los 1000 datos de X e Y, calculamos Z

uZ &amp;lt;- sd(Z) # La incertidumbre estándar de Z es la desviación estándar de las
            # n = 1000 simulaciones&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;En nuestro ejemplo, la incertidumbre estándar por Monte Carlo es de &lt;span class=&#34;math inline&#34;&gt;\(u_{Z}^{MC} = 7.4\)&lt;/span&gt;. ¿Qué nos decía la teoría? Que &lt;span class=&#34;math inline&#34;&gt;\(u_{Z} = \sqrt{2}\sigma = \sqrt{2}\cdot 5 = 7.1\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Ojalá todo fuera tan fácil. El ejemplo era muy sencillo y la solución es conocida en forma teórica. La vida del químico analítico es extremadamente compleja (en todo $entido), y no siempre existe una solución tan simple. Para eso está el método de Monte Carlo, el cual simula un proceso complejo cuyas variables de entrada pueden tener cualquier distribución de probabilidad tal como lo muestra la siguiente figura:&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;https://www.analytical.cl/img/mc2.png&#34; width=&#34;500&#34; /&gt;

&lt;/div&gt;
&lt;p&gt;La generalidad del método MC no asume normalidad de la variable de interés &lt;span class=&#34;math inline&#34;&gt;\(g(y)\)&lt;/span&gt;, sino más bien la estima como una distribución empírica y a partir de ésta calcula la incertidumbre estándar y expandida.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;incertidumbre-de-un-factor-de-dilucion&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Incertidumbre de un factor de dilución&lt;/h1&gt;
&lt;p&gt;Para aterrizar esta definición veamos un ejemplo muy simple en química analítica y cómo podemos implementarlo en un lenguaje de programación especialmente dedicado a esta tareas: &lt;code&gt;R&lt;/code&gt;. A su vez discutiremos las principales diferencias entre el método GUM y el método de Monte Carlo&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Se prepara la dilución de una muestra antes de su lectura por AAS, mediante la toma de una alícuota de 20 mL con una pipeta volumétrica cuyo volumen es &lt;span class=&#34;math inline&#34;&gt;\(20,0 \pm 0,1\)&lt;/span&gt; mL y su dilución en un matraz de 100 mL, con un volumen de &lt;span class=&#34;math inline&#34;&gt;\(100 \pm 0,6\)&lt;/span&gt; mL. Calcular la incertidumbre del factor de dilución &lt;span class=&#34;math inline&#34;&gt;\(f = V_{final}/V_{inicial}\)&lt;/span&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div id=&#34;metodo-gum&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Método GUM&lt;/h2&gt;
&lt;p&gt;Este es un ejercicio bastante simple para el método GUM, pues el factor de dilución es una operación de división, por lo que aplicando las reglas de propagación de la incertidumbre de una división, obtenemos lo siguiente:&lt;/p&gt;
&lt;span class=&#34;math display&#34; id=&#34;eq:f&#34;&gt;\[\begin{equation}
  u_{f} = f\sqrt{\left(\frac{u_{V_{final}}}{V_{final}}\right)^2 + 
  \left(\frac{u_{V_{inicial}}}{V_{incial}}\right)^2}
  \tag{1}
\end{equation}\]&lt;/span&gt;
&lt;p&gt;Asumiremos por simplicidad que las incertidumbres asociadas al material volumétrico son las indicadas por el fabricante en el mismo material, es decir, de acuerdo a la figura &lt;a href=&#34;#fig:matraz&#34;&gt;1&lt;/a&gt; y, por ahora, serán las únicas fuentes de incertidumbre del material volumétrico (olvidaremos la T° y la repetibilidad).&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:matraz&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/img/pipeta.jpg&#34; alt=&#34;Incertidumbre del fabricante&#34;  /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 1: Incertidumbre del fabricante
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Ahora bien, las incertidumbres del material volumétrico corresponden a incertidumbres expandidas &lt;span class=&#34;math inline&#34;&gt;\(U\)&lt;/span&gt;, por lo tanto, debemos convertirlas a incertidumbres estándares antes de aplicar la ecuación &lt;a href=&#34;#eq:f&#34;&gt;(1)&lt;/a&gt;. También por simplicidad, modelaremos los volúmenes mediante una distribución rectangular, por lo tanto, al estandarizar &lt;span class=&#34;math inline&#34;&gt;\(u = U/k\)&lt;/span&gt;, con &lt;span class=&#34;math inline&#34;&gt;\(k = \sqrt{3}\)&lt;/span&gt; obtenemos lo siguiente:&lt;/p&gt;
&lt;span class=&#34;math display&#34;&gt;\[\begin{eqnarray}
  u_{V_{final}} &amp;amp;=&amp;amp; \frac{0,6}{\sqrt{3}} = 0.35\, \text{mL}\\
  u_{V_{incial}} &amp;amp;=&amp;amp; \frac{0,1}{\sqrt{3}} = 0.06\, \text{mL}\\
  u_{f} &amp;amp;=&amp;amp; \frac{100}{20}\sqrt{\left(\frac{0.35}{100}\right)^2 + 
  \left(\frac{0.06}{20}\right)^2} \\
    u_{f} &amp;amp;=&amp;amp;  0.02255
\end{eqnarray}\]&lt;/span&gt;
&lt;p&gt;En este ejemplo, podemos asumir que los grados de libertad de ambas incertidumbres tienden a infinito, por lo tanto, si queremos obtener la incertidumbre expandida del factor de dilución con un 95% de confianza, se asume un factor de cobertura &lt;span class=&#34;math inline&#34;&gt;\(k = 2\)&lt;/span&gt;, de esta forma obtenemos &lt;span class=&#34;math inline&#34;&gt;\(U_{f} = ku_{f} = 0.04509\)&lt;/span&gt; mL.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;metodo-de-monte-carlo&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Método de Monte Carlo&lt;/h2&gt;
&lt;p&gt;Implementaremos en &lt;code&gt;R&lt;/code&gt;, los pasos descritos del método de Monte Carlo:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;k &amp;lt;- sqrt(3) # Factor de estandarización para una distribución rectangular
vi &amp;lt;- 20     # Volumen inicial [mL]
Uvi &amp;lt;- 0.1   # Incertidumbre expandida del volumen inicial [mL]
uvi &amp;lt;- Uvi/k # Incertidumbre estándar del volumen inicial [mL]
vf &amp;lt;- 100    # Volumen incial [mL]
Uvf &amp;lt;- 0.6   # Incertidumbre expandida del volumen final [mL]
uvf &amp;lt;- Uvf/k # Incertidumbre estándar del volumen final [mL]

# Aquí haremos la simulación de Monte Carlo
set.seed(123) # Para que Ud. obtenga los mismos resultados en su simulación

# Generaremos valores aleatorios de volumen inicial y volumen final
# desde una distribución rectangular con el comando runif(n, minimo, maximo)
# minimo = volumen - U
# maximos = volumen + U
# Los guardaremos en los vectores vi.sim y vf.sim

n &amp;lt;- 1000
vi.sim &amp;lt;- runif(n, vi - Uvi, vi + Uvi)
vf.sim &amp;lt;- runif(n, vf - Uvf, vf + Uvf)

# Ahora calcularemos el factor de dilución para cada uno de los pares de 
# valores de volumen inicial y final que simulamos y lo guardaremos en el
# el vector f.sim

f.sim &amp;lt;- vf.sim/vi.sim # Es la misma fórmula&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;“Bueno ¿Y?” se preguntará Ud.&lt;/p&gt;
&lt;p&gt;Veamos que hemos generado con la simulación:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(n = 1000\)&lt;/span&gt; valores aleatorios del volumen inicial a partir de una distribución rectangular con media &lt;code&gt;vi&lt;/code&gt; = 20 mL e incertidumbre expandida &lt;code&gt;Uvi&lt;/code&gt; = 0.1 mL. El promedio de los 1000 volumenes iniciales simulados es 19.999 mL y una desviación estándar de &lt;code&gt;uvi&lt;/code&gt; = &lt;span class=&#34;math inline&#34;&gt;\(U_{vf}/\sqrt{3} = 0.058\)&lt;/span&gt; mL. La figura &lt;a href=&#34;#fig:visim&#34;&gt;2&lt;/a&gt; muestra el histograma de los valores simulados. Note que la simulación concuerda perfectamente con los valores de incertidumbre informados por el fabricante (&lt;span class=&#34;math inline&#34;&gt;\(20 \pm 0.1\)&lt;/span&gt; mL).&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:visim&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/2017-09-12-validacion-de-los-calculos-de-incertidumbre-en-quimica-analitica-con-el-metodo-monte-carlo_files/figure-html/visim-1.png&#34; alt=&#34;Histograma de los valores simulados de volumen inicial [mL]&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 2: Histograma de los valores simulados de volumen inicial [mL]
&lt;/p&gt;
&lt;/div&gt;
&lt;ol start=&#34;2&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n = 1000\)&lt;/span&gt; valores aleatorios del volumen final a partir de una distribución rectangular con media &lt;code&gt;vf&lt;/code&gt; = 100 mL e incertidumbre expandida &lt;code&gt;Uvf&lt;/code&gt; = 0.6 mL.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Para cada uno de los pares datos simulados de volumen inicial y final, se calculó el factor de dilución, por lo tanto, se obtuvieron en total &lt;span class=&#34;math inline&#34;&gt;\(n = 1000\)&lt;/span&gt; factores los cuales se “guardaron” en el vector &lt;code&gt;f.sim&lt;/code&gt;, tal como se muestra en la tabla &lt;a href=&#34;#tab:fsim&#34;&gt;1&lt;/a&gt;:&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;table&gt;
&lt;caption&gt;&lt;span id=&#34;tab:fsim&#34;&gt;Table 1: &lt;/span&gt;Variables simuladas. Se muestran los primeros 6 datos&lt;/caption&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;vf.sim&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;vi.sim&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;f.sim&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;99.73&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;19.96&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5.00&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;100.11&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;20.06&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4.99&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;99.59&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;19.98&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4.98&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;100.42&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;20.08&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5.00&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;100.42&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;20.09&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5.00&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;99.97&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;19.91&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5.02&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ol start=&#34;4&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;La figura &lt;a href=&#34;#fig:fsimhis&#34;&gt;3&lt;/a&gt; muestra el histograma de los 1000 factores de dilución simulados:&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:fsimhis&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/2017-09-12-validacion-de-los-calculos-de-incertidumbre-en-quimica-analitica-con-el-metodo-monte-carlo_files/figure-html/fsimhis-1.png&#34; alt=&#34;Histograma de factores de dilución simulados&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 3: Histograma de factores de dilución simulados
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;“¡Qué interesante!”, dirá Ud., la división de dos variables rectangulares genera una distribución de datos que, al menos, es simétrica. ¿Es razonable asumir una distribución normal del factor de dilución simulado? Si recuerda la discusión en este &lt;a href=&#34;https://www.analytical.cl/post/mis-datos-no-son-normales/&#34;&gt;post&lt;/a&gt;, podemos evaluar la admisibilidad de esta hipótesis mediante el análisis gráfico &lt;em&gt;QQ-Plot&lt;/em&gt; de normalidad de los datos simulados y el test de Shapiro, el cual se muestra en la figura &lt;a href=&#34;#fig:fsimnorm&#34;&gt;4&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:fsimnorm&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/2017-09-12-validacion-de-los-calculos-de-incertidumbre-en-quimica-analitica-con-el-metodo-monte-carlo_files/figure-html/fsimnorm-1.png&#34; alt=&#34;QQ-Plot de normalidad de los n factores de dilución simulados&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 4: QQ-Plot de normalidad de los n factores de dilución simulados
&lt;/p&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code&gt;
    Shapiro-Wilk normality test

data:  f.sim
W = 0.99005, p-value = 2.719e-06&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Aparentemente, el modelo normal sería razonable para modelar el factor de dilución sino fuera por los siguientes hechos:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;El histograma del factor de dilución tiene “colas livianas”, lo cual se puede advertir en el &lt;em&gt;QQ-plot&lt;/em&gt; de normalidad en los valores extremos.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;La evidencia del test de Shapiro en contra de la hipótesis de normalidad.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Y lo más importante, la razón de dos variables independientes rectangulares (uniformes) teóricamente no es Normal (está demostrado).&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Ok, probablemente esta discusión no sea de mucho interés por ahora, pero nos dará pistas para dirigir la discusión posterior.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Entonces ¿Cómo obtenemos la incertidumbre del factor de dilución por el método de Monte Carlo?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Muy sencillo, a partir de la desviación estándar de los factores de dilución simulados, es decir, $u_{f}^{MC} = $ &lt;code&gt;sd(f.sim)&lt;/code&gt; = 0.02302. Como podrá advertir, es muy similar a la obtenida por el método GUM &lt;span class=&#34;math inline&#34;&gt;\(u_{f} = 0.02255\)&lt;/span&gt;, la diferencia relativa es de un 2.1 %. Es más, ajustando a las cifras significativas correctas se obtiene la misma magnitud 0.02&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;¿Queda validado el método GUM con los cálculos del método de Monte Carlo? Desde el punto de vista metrológico químico: Sí. Desde el punto de vista numérico: Depende.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Lo que sucede es que el numeral 8.1 del suplemento 1 dela guía GUM es explícito en establecer un criterio de aceptación entre el método GUM y el método de Monte Carlo (MC):&lt;/p&gt;
&lt;span class=&#34;math display&#34;&gt;\[\begin{eqnarray}
  |y - U(y) - y_{low}| &amp;amp;&amp;lt;&amp;amp; \xi \\
  |y + U(y) - y_{high}| &amp;amp;&amp;lt;&amp;amp; \xi
\end{eqnarray}\]&lt;/span&gt;
&lt;p&gt;donde &lt;span class=&#34;math inline&#34;&gt;\(y \pm U(y)\)&lt;/span&gt; es el valor calculado de la variable y su incertidumbre expandida estimada por el método GUM; &lt;span class=&#34;math inline&#34;&gt;\(y_{low}\)&lt;/span&gt; e &lt;span class=&#34;math inline&#34;&gt;\(y_{high}\)&lt;/span&gt; corresponden a los percentiles 2.5 y 97.5 de los datos simulados, es decir, el intervalo de incertidumbre al 95% de confianza calculado por el método de Monte Carlo. &lt;span class=&#34;math inline&#34;&gt;\(\xi\)&lt;/span&gt; es la tolerancia numérica entre ambas metodologías de cálculo. Es decir, es un test de precisión numérica, no metrológica.&lt;/p&gt;
&lt;p&gt;El valor de &lt;span class=&#34;math inline&#34;&gt;\(\xi\)&lt;/span&gt; está relacionado las cifras significativas que tienen sentido físico-químico y metrológico. Por ejemplo, si para una gravimetría usamos una balanza granataria cuya incertidumbre es del orden de &lt;span class=&#34;math inline&#34;&gt;\(\pm 0.1\)&lt;/span&gt; g, no podríamos elegir una tolerancia numérica de &lt;span class=&#34;math inline&#34;&gt;\(0.00001\)&lt;/span&gt; g. Para establecer &lt;span class=&#34;math inline&#34;&gt;\(\xi\)&lt;/span&gt; la guía indica lo siguiente:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;Exprese &lt;span class=&#34;math inline&#34;&gt;\(u(y)\)&lt;/span&gt; en notación científica manteniendo las cifras significativas. En nuestro caso obtuvimos &lt;span class=&#34;math inline&#34;&gt;\(u_{f} = 0.0225\)&lt;/span&gt;, la cual puede ser redondeada a una cifra significativa &lt;span class=&#34;math inline&#34;&gt;\(u_{f} = 0.02\)&lt;/span&gt;. Esta incertidumbre, entonces, se expresa como &lt;span class=&#34;math inline&#34;&gt;\(2 \cdot 10^{-2}\)&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Para obtener &lt;span class=&#34;math inline&#34;&gt;\(\xi\)&lt;/span&gt;, utilice el exponente de la potencia de 10 (t = -2) del paso anterior, en la siguiente expresión:&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;span class=&#34;math display&#34;&gt;\[\begin{eqnarray}
  \xi &amp;amp;=&amp;amp; \frac{1}{2}\times 10^{t} \\
  \xi &amp;amp;=&amp;amp; \frac{1}{2}\times 10^{-2}\\
  \xi &amp;amp;=&amp;amp; 0.005
\end{eqnarray}\]&lt;/span&gt;
&lt;blockquote&gt;
&lt;p&gt;¿Cómo obtenemos los percentiles 2.5 y 97.5 de la simulación de Monte Carlo?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Muy sencillo, con el comando &lt;code&gt;quantile&lt;/code&gt;:&lt;/p&gt;
&lt;p&gt;Esto quiere decir, que de los &lt;span class=&#34;math inline&#34;&gt;\(n = 1000\)&lt;/span&gt; datos simulados del factor de dilución, un 95% se encuentra dentro del intervalo [4.96, 5.04]. La figura &lt;a href=&#34;#fig:quantilofig&#34;&gt;5&lt;/a&gt; muestra este intervalo en el histograma de los datos simulados:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;hist(f.sim, 
     xlab = &amp;#39;Factor de dilución&amp;#39;,
     main = &amp;#39;&amp;#39;,
     freq = T,
     breaks = 20,
     xlim = c(4.93, 5.07))

abline(v = quantilos[1], col = &amp;#39;red&amp;#39;)
abline(v = quantilos[2], col = &amp;#39;red&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:quantilofig&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/2017-09-12-validacion-de-los-calculos-de-incertidumbre-en-quimica-analitica-con-el-metodo-monte-carlo_files/figure-html/quantilofig-1.png&#34; alt=&#34;Intervalo de confianza al 95% de los datos simulados del factor de dilución&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 5: Intervalo de confianza al 95% de los datos simulados del factor de dilución
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Por lo tanto, sólo nos queda calcular &lt;span class=&#34;math inline&#34;&gt;\(U(y)\)&lt;/span&gt; que es la incertidumbre expandida del factor de dilución calculada por el método GUM. De acuerdo a la guía &lt;span class=&#34;math inline&#34;&gt;\(U = k\cdot u\)&lt;/span&gt;, donde &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; es el factor de cobertura para obtener un intervalo de incertidumbre con cierto grado de confianza. Aquí es donde la guía GUM asume, bajo ciertas condiciones (ver numeral G.2.3), que la variable de respuesta, en este caso factor de dilución, puede aproximarse a una distribución Normal donde &lt;span class=&#34;math inline&#34;&gt;\(k \approx 2\)&lt;/span&gt;. Advierta que para nuestro ejemplo esta suposición no tiene mucho asidero. Por lo tanto, siguiendo las directrices de la guía GUM &lt;span class=&#34;math inline&#34;&gt;\(U_{f} = 2\cdot 0.023 = 0.05\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Con todos los datos estimados, llevemos a cabo el test de validación entre el método GUM y el método de Monte Carlo:&lt;/p&gt;
&lt;span class=&#34;math display&#34;&gt;\[\begin{eqnarray}
  |5 - 0.045 - 4.957| &amp;amp;&amp;lt;&amp;amp; 0.005 \\
  |5 + 0.045 - 5.043| &amp;amp;&amp;lt;&amp;amp; 0.005
\end{eqnarray}\]&lt;/span&gt;
&lt;blockquote&gt;
&lt;p&gt;En ambos casos &lt;span class=&#34;math inline&#34;&gt;\(0.002 &amp;lt; 0.005\)&lt;/span&gt;, por lo tanto, el método GUM queda validado&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;Insisto con lo del mago Tamariz: ¡chiararáaa!&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Observaciones:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;Si bien en este ejemplo sólo utilizamos &lt;span class=&#34;math inline&#34;&gt;\(n = 1000\)&lt;/span&gt; simulaciones, en la práctica se requieren muchas más (&lt;span class=&#34;math inline&#34;&gt;\(10^{5} - 10^{6}\)&lt;/span&gt;). El suplemento 1 de la GUM entrega más directrices en este tema.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Mientras mayor sea el grado de no linealidad de la ecuación de medición, más divergencias habrá entre GUM y MC. Siendo este último el de mayor generalidad.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Si bien se puede implementar Monte Carlo en Excel, es una tarea bastante engorrosa pues debe programarlo en Visual Basic. Le sugiero utilizar lenguajes de programación más modernos como &lt;code&gt;R&lt;/code&gt; o &lt;code&gt;Python&lt;/code&gt;, los cuales tienen librerías especializadas en métodos de simulación.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;A mayor asimetría de la distribución empírica, mayores diferencias habrá entre ambos métodos.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Dé un sentido químico a la simulación ¿&lt;a href=&#34;https://www.analytical.cl/post/mis-datos-no-son-normales/&#34;&gt;Recuerda que la pureza química no es Normal&lt;/a&gt;? Intente con la distribución Beta la cual es más apropiada para modelar pureza.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;En este post hemos validado el método GUM frente a Monte Carlo “a mano”, es decir, hemos hecho el test en forma manual. En el &lt;a href=&#34;https://www.analytical.cl/post/validacion-calculos-incertidumbre-quimica-analitica-metodo-monte-carlo/&#34;&gt;próximo post&lt;/a&gt; utilizaremos la librería &lt;code&gt;metRology&lt;/code&gt; la cual incorpora la validación de GUM con MC en un único comando &lt;code&gt;GUM.validate&lt;/code&gt;… ¡y listo!.&lt;/p&gt;
&lt;p&gt;Hasta la próxima.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;bibliografia&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Bibliografía&lt;/h2&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;Evaluation of measurement data – Guide to the expression of uncertainty in measurement JCGM 100:2008&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Evaluation of measurement data – Supplement 1 to the “Guide to the expression of uncertainty in measurement” – Propagation of distributions using a Monte Carlo method JCGM 101:2008&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Stephen L R Ellison &lt;em&gt;metRology: Support for Metrological Applications&lt;/em&gt; R package version 0.9-23-2, 2016.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>¡Mis datos no son normales! ¿Qué hago?...Cálmese, nunca lo fueron... ni lo serán</title>
      <link>https://www.analytical.cl/post/mis-datos-no-son-normales/</link>
      <pubDate>Fri, 08 Sep 2017 00:00:00 +0000</pubDate>
      
      <guid>https://www.analytical.cl/post/mis-datos-no-son-normales/</guid>
      <description>&lt;p&gt;Bueno, aquí va la primera piedra:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;No existen datos experimentales normales&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Sus datos obtenidos en el laboratorio no “siguen” ninguna distribución de probabilidad. La naturaleza no “sigue” ninguna distribución de probabilidad.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;La Normalidad es sólo una abstracción, es un modelo matemático de un fenómeno aleatorio.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Y como todo modelo, podría ser razonable para un conjunto de datos y totalmente equivocado para otro. Somos nosotros, los químicos/científicos, quienes proponemos modelos del sistema que estamos estudiando y a través de la experimentación corroboramos o no estos modelos.&lt;/p&gt;
&lt;p&gt;Todos los tests estadísticos formales para evaluar la normalidad tampoco responden en forma 100% certera si esta hipótesis es válida, pues están afectos a los errores de tipo falso positivo (I) y falso negativo (II). Por lo tanto, las pruebas estadísticas en la práctica no confirman que los datos experimentales sean Normales, sino que nos indican si el modelo Normal es razonable o no. Si lo es, actuamos como si “fuesen” normales y hacemos inferencia estadística a partir de las propiedades de la Normal.&lt;/p&gt;
&lt;p&gt;El modelo Normal se describe en la ecuación &lt;a href=&#34;#eq:normal&#34;&gt;(1)&lt;/a&gt; y la figura &lt;a href=&#34;#fig:plotnormal&#34;&gt;1&lt;/a&gt; muestra la archiconocida forma de campana:&lt;/p&gt;
&lt;span class=&#34;math display&#34; id=&#34;eq:normal&#34;&gt;\[\begin{equation}
  f(x) = \frac{1}{\sigma \sqrt{2\pi}}\exp{-\frac{1}{2}\left(\frac{x - \mu}{\sigma}\right)^2}
  \tag{1}
\end{equation}\]&lt;/span&gt;
&lt;p&gt;donde &lt;span class=&#34;math inline&#34;&gt;\(\sigma\)&lt;/span&gt; y &lt;span class=&#34;math inline&#34;&gt;\(\mu\)&lt;/span&gt; son la desviación estándar y media, respectivamente. Notar que la distribución Normal es aplicable sólo a variables &lt;strong&gt;continuas&lt;/strong&gt;, tales como concentración, temperatura, masa, etc. No se puede aplicar la distribución normal a variables &lt;strong&gt;discretas&lt;/strong&gt; como cuentas de células bajo un campo de microscopio, por ejemplo. Quizás algún microbiólogo está familiarizado con el uso de logaritmos en sus cálculos de incertidumbre, bueno, es porque se utilizan otros modelos de probabilidad para datos discretos (ufc), como el modelo Poisson.&lt;/p&gt;
&lt;p&gt;Advierta también, que los posibles valores que puede tomar la variable &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt; están en el no despreciable rango entre &lt;span class=&#34;math inline&#34;&gt;\(-\infty\)&lt;/span&gt; y &lt;span class=&#34;math inline&#34;&gt;\(+\infty\)&lt;/span&gt;. ¿Ha comprado algún estándar de calibración cuyo certificado indique una pureza de &lt;span class=&#34;math inline&#34;&gt;\(99.7 \pm 0.5\)&lt;/span&gt; %? Raro ¿no? Bueno, pues el proveedor ha aplicado equivocadamente la distribución Normal a una variable que no es Normal: pureza química. En efecto, desde el punto de vista químico la pureza está confinada al intervalo &lt;span class=&#34;math inline&#34;&gt;\([0, 100]\)&lt;/span&gt; %, por lo tanto, no tiene sentido químico un certificado que indique &lt;span class=&#34;math inline&#34;&gt;\(99.7 \pm 0.5\)&lt;/span&gt; %. Para modelar pureza química es necesario utilizar una distribución de probabilidad que esté restringida al intervalo &lt;span class=&#34;math inline&#34;&gt;\([0, 100]\)&lt;/span&gt; % (o &lt;span class=&#34;math inline&#34;&gt;\([0, 1]\)&lt;/span&gt;) como, por ejemplo, la distribución Beta.&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:plotnormal&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/2017-09-08-mis-datos-no-son-normales-qué-hago-cálmese-nunca-lo-fueron-ni-lo-serán_files/figure-html/plotnormal-1.png&#34; alt=&#34;Distribución Normal con media = 0 y sd = 1 &#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 1: Distribución Normal con media = 0 y sd = 1
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Existen varios test para evaluar la palusibilidad de la normalidad de los datos, pero en este post discutiremos sólo dos de ellos: El test de Shapiro-Wilk y el Test de Anderson-Darling.&lt;/p&gt;
&lt;p&gt;La matemática detrás de estos tests no es muy digerible, por lo que simplemente los ejemplificaremos con algunos datos reales y simulados. La ventaja de usar simulaciones es que “creamos” artificialmente datos de la distribución que se nos plazca y así verificar el desempeño de estos tests. Si recuerda, ya habíamos utilizado la simulación cuando revisamos las pruebas de linealidad en este &lt;a href=&#34;https://www.analytical.cl/post/como-demuestro-que-mi-curva-de-calibracion-es-lineal/&#34;&gt;post&lt;/a&gt;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Antes de hacer cualquier prueba estadística de normalidad grafique los datos, a través de un histograma y un gráfico de probabilidad Normal&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Estos gráficos le darán una primera aproximación para evaluar el supuesto de normalidad. Todos los softwares estadísticos incorporan estos gráficos. A continuación los veremos en acción en datos normales simulados en lenguaje &lt;code&gt;R&lt;/code&gt;, qué otro. El siguiente es el código para llevar a cabo esta simulación de &lt;span class=&#34;math inline&#34;&gt;\(n = 100\)&lt;/span&gt; datos normales:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;set.seed(123) # Con este comando nos aseguramos de generar siempre
              # los mismos datos aleatorios. Sino, obviamente, todos
              # generaríamos números distintos pues son aleatorios ¿no?

n &amp;lt;- 100 # Número de datos a simular
mu &amp;lt;- 10 # Media de los n = 100 datos
sigma &amp;lt;- 1 # Desviación estándar de los n = 100 datos

# Genera 100 dato normales con media mu y desviación estándar sigma
# y guárdalos en el vector llamado x
x &amp;lt;- rnorm(n, mu, sigma)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Al calcular la media y desviación estándar (muestral) de estos datos obtenemos &lt;span class=&#34;math inline&#34;&gt;\(\overline{x} = 10.1\)&lt;/span&gt; y &lt;span class=&#34;math inline&#34;&gt;\(s = 0.9\)&lt;/span&gt; “¿Pero cómo? ¿No habíamos simulado una media de 10 y desviación estándar 1? Esto es una estafa” &lt;em&gt;Keep calm&lt;/em&gt; recuerde que son aleatorios. La figura &lt;a href=&#34;#fig:normplot&#34;&gt;2&lt;/a&gt; muestra a la izquierda el histograma y a la derecha el gráfico de normalidad (&lt;em&gt;QQ-Plot&lt;/em&gt;) de los datos simulados:&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:normplot&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/2017-09-08-mis-datos-no-son-normales-qué-hago-cálmese-nunca-lo-fueron-ni-lo-serán_files/figure-html/normplot-1.png&#34; alt=&#34;Izquierda histograma, derecha gráfico de normalidad&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 2: Izquierda histograma, derecha gráfico de normalidad
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;El histograma muestra esa forma de campana característica de la distribución normal. Quizás no conozca el gráfico de probabilidad normal o &lt;em&gt;QQ-Plot&lt;/em&gt;, pero es la primera evidencia que un estadístico revisa para evaluar la hipótesis de normalidad. Note que la “mayoría” de los datos está sobre una línea diagonal roja, cuando Ud. observe este patrón podría concluir que el modelo normal es &lt;strong&gt;razonable&lt;/strong&gt; o adecuado para modelar sus datos.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;¿Son concluyentes estos gráficos? No, en absoluto. Simplemente muestran que la normalidad es una hipótesis plausible.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Recuerde que estos datos son simulados, por lo tanto, era esperable este comportamiento. Pero sus datos experimentales son “reales”, &lt;em&gt;a priori&lt;/em&gt; no sabe qué comportamiento podrían evidenciar, sólo puede plantear una hipótesis.&lt;/p&gt;
&lt;p&gt;Apliquemos ahora los test “formales” de linealidad: test de Shapiro y test de Anderson. Ambos tests intentan evaluar la hipótesis nula &lt;span class=&#34;math inline&#34;&gt;\(H_{0}\)&lt;/span&gt; que los datos provienen de una distribución Normal:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(nortest) # Cargamos esta librería que contiene varios test de
                 # Normalidad, entre ellos Anderson-Darling

# Test de Shapiro-Wilk (no requiere librería nortest)
shapiro.test(x)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
    Shapiro-Wilk normality test

data:  x
W = 0.99388, p-value = 0.9349&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# test de Anderson-Darling
ad.test(x)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
    Anderson-Darling normality test

data:  x
A = 0.182, p-value = 0.9104&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;La interpretación tradicional de las pruebas de hipótesis sería más o menos la siguiente:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Ya que el &lt;em&gt;p-value&lt;/em&gt; &amp;gt; 0,05, entonces, no hay evidencia para rechazar la hipótesis de normalidad de los datos. ¿Se conluye, entonces, que los datos son normales? No. Simplemente, no tenemos la evidencia para rechzar la hipótesis.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Por lo tanto, no es que los datos sean normales, sino que la hipótesis de normalidad es razonable, por lo que actuaremos como si fuese cierto. Obviamente, estos resultados eran esperables pues hemos “creado” datos normales, pero recuerde que sus datos son “reales”, no simulados. Hay otras consideraciones de las pruebas de hipótesis que no mencionaremos por espacio, pero que un post futuro discutiremos en profundidad. Especialmente, esta perversa dicotomía del &lt;em&gt;p-value&lt;/em&gt; &amp;lt; ó &amp;gt; 0,05 de la cual ya hicimos mención en este &lt;a href=&#34;https://www.analytical.cl/post/como-demuestro-que-mi-curva-de-calibracion-es-lineal/&#34;&gt;post&lt;/a&gt;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;“The p-value was never intended to be a substitute for scientific reasoning” Ron Wasserstein, Director Ejecutivo de la Asociación Americana de Estadística ASA.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Nota&lt;/strong&gt;: Para tamaños de muestra grandes (&lt;span class=&#34;math inline&#34;&gt;\(n &amp;gt; 1000\)&lt;/span&gt;), una pequeña desviación de la normalidad hará que los tests estadísticos acusen No Normalidad&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Cuando nos referimos a “actuar como si fuese cierto”, estamos diciendo que todos aquellos procedimientos estadísticos que suponen normalidad de los datos, funcionarán de acuerdo a la teoría. ¿Cuáles son estos métodos estadísticos que requieren normalidad de los datos?:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Test de Student en todas sus variantes (es un test de sesgo)&lt;/li&gt;
&lt;li&gt;Test de Fisher para comparar varianzas (precisión analítica de 2 métodos)&lt;/li&gt;
&lt;li&gt;Curva de calibración lineal&lt;/li&gt;
&lt;li&gt;Máxima diferencia tolerable entre duplicados de análisis, discutido &lt;a href=&#34;https://www.analytical.cl/post/cual-maxima-diferencia-tolerable-entre-duplicados-analisis/&#34;&gt;aquí&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Análisis de varianza para evaluar varios métodos analíticos o analistas&lt;/li&gt;
&lt;li&gt;Intervalos de confianza para la media de concentraciones.&lt;/li&gt;
&lt;li&gt;Incertidumbre de métodos analíticos. El &lt;span class=&#34;math inline&#34;&gt;\(k = 2\)&lt;/span&gt; asume normalidad de las concentraciones.&lt;/li&gt;
&lt;li&gt;… y un largo etc.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Ok, es cierto, a medida que aumenta el &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; la suposición de normalidad es cada vez menos relevante. De hecho algunos de los tests mencionados arriba son más o menos “robustos” a la suposición de normalidad.&lt;/p&gt;
&lt;div id=&#34;que-observariamos-si-la-hipotesis-de-normalidad-fuese-totalmente-inverosimil-para-modelar-nuestros-datos&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;¿Qué observaríamos si la hipótesis de normalidad fuese totalmente inverosímil para modelar nuestros datos?&lt;/h1&gt;
&lt;p&gt;Simulemos ahora datos no normales y veamos cuáles son los resultados tanto de los gráficos exploratorios como de las pruebas estadísticas formales:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Simularemos m = 100 datos discretos de una distribución Poisson

set.seed (123) # Para que pueda reproducir los datos
m &amp;lt;- 100 # m = 100 datos
lambda &amp;lt;- 5 # Parámetro de la distribución Poisson

# Generar m = 100 datos de una distribución Poisson con parámtro lambda = 5
y &amp;lt;- rpois(m, lambda)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://www.analytical.cl/post/2017-09-08-mis-datos-no-son-normales-qué-hago-cálmese-nunca-lo-fueron-ni-lo-serán_files/figure-html/unnamed-chunk-1-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;alert alert-warning&#34;&gt;
  &lt;p&gt;¿No les parece familiar el QQ-Plot a aquellos que validan homogeneidad de peso en validación de procesos farmacéuticos? 1313&lt;/p&gt;

&lt;/div&gt;

&lt;p&gt;La evidencia de los gráficos es abrumadora, los datos no son normales. Esto concuerda con lo que muestran los tests estadísticos de normalidad:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Test de Shapiro-Wilk (no requiere librería nortets)
shapiro.test(y)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
    Shapiro-Wilk normality test

data:  y
W = 0.97077, p-value = 0.02531&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# test de Anderson-Darling
ad.test(y)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
    Anderson-Darling normality test

data:  y
A = 1.2355, p-value = 0.003072&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Como era esperable, ambos tests confirman que la hipótesis de normalidad no es razonable para modelar los datos(&lt;em&gt;p-value&lt;/em&gt; &amp;lt; 0,05)&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;si-mis-datos-no-son-normales-entonces-como-los-analizo&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Si mis datos no son normales, entonces ¿Cómo los analizo?&lt;/h1&gt;
&lt;p&gt;Tranquilo(a), el mundo sigue girando. Existen varios métodos estadísticos que Ud. puede utilizar para analizar datos donde la hipótesis de normalidad no es razonable o se ha demostrado empíricamente que no es :&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;strong&gt;Bootstrap&lt;/strong&gt;: Utilizado, entre otros propósitos, para obtener intervalos de confianza para datos no normales.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Tests no paramétricos&lt;/strong&gt;: Análogos a las pruebas paramétricas tradicionales (Test T, ANOVA, etc.)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Tests de permutaciones&lt;/strong&gt;: También son una excelente alternativa a las pruebas paramétricas tradicionales y funcionan, incluso, para conjuntos pequeños de datos. Son tests “exactos”, pero necesitan que Ud. disponga de un buen “tarro” (computador) pues son &lt;em&gt;computationally-intensive methods&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Modelos lineales generalizados&lt;/strong&gt;: Idóneos para modelar datos discretos como cuentas de células (leucocitos, ufc, etc.) o variables dicotómicas (Conforme/No Conforme), etc.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Transformación de datos&lt;/strong&gt;: Especialmente útiles son la transformación de Johnson y la de Box-Cox.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Estadística Robusta&lt;/strong&gt;: No tan sólo son útiles para minimizar el efecto de valores anómalos (&lt;em&gt;outliers&lt;/em&gt;), sino también para obener estimadores de datos que no son normales.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Para finalizar veamos en acción de estos métodos: Bootstrap. Sin embargo, el detalle estadístico y su implementación los veremos en otro post, por ahora, simplemente lo ejemplificaremos. La figura &lt;a href=&#34;#fig:As&#34;&gt;3&lt;/a&gt; muestra el histograma y el &lt;em&gt;QQ-Plot&lt;/em&gt; de normalidad correspondientes a datos de concentración de arsénico [ppm] muestreados en &lt;span class=&#34;math inline&#34;&gt;\(n = 271\)&lt;/span&gt; pozos de agua en Bangladesh:&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:As&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/2017-09-08-mis-datos-no-son-normales-qué-hago-cálmese-nunca-lo-fueron-ni-lo-serán_files/figure-html/As-1.png&#34; alt=&#34;Histograma y QQ-Plot datos de Arsénico [ppm] en n = 271 pozos en Bangladesh&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 3: Histograma y QQ-Plot datos de Arsénico [ppm] en n = 271 pozos en Bangladesh
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Claramente, ni si quiera es necesario hacer un test de normalidad, la evidencia que muestra la figura &lt;a href=&#34;#fig:As&#34;&gt;3&lt;/a&gt; en contra de la hipótesis de normalidad es abrumadora. El promedio de la concentración de As es &lt;span class=&#34;math inline&#34;&gt;\(\overline{x} = 125\)&lt;/span&gt; ppm y la desviación estándar &lt;span class=&#34;math inline&#34;&gt;\(s = 298\)&lt;/span&gt; ppm. Utilizando la fórmula usual para estimar un intervalo de confianza al 95% para la media &lt;span class=&#34;math inline&#34;&gt;\(\overline{x} \pm t_{\alpha/2, n - 1} s/\sqrt{n}\)&lt;/span&gt; obtenemos [90, 161] ppm As. Sin embargo, la gran asimetría de los datos hace inverosímil el intervalo obtenido.&lt;/p&gt;
&lt;p&gt;Al aplicar el método &lt;em&gt;bootstrap&lt;/em&gt; obtenemos un intervalo para la media al 95% (BCa) entre [98, 175] ppm As, el cual es más “correcto” por si Ud. necesita informar este parámetro. La figura &lt;a href=&#34;#fig:Asboot&#34;&gt;4&lt;/a&gt; muestra el histograma y QQ-Plot de normalidad de el método de bootstrap. Advierta el Teorema Central del Límite en su máxima expresión.&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:Asboot&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/2017-09-08-mis-datos-no-son-normales-qué-hago-cálmese-nunca-lo-fueron-ni-lo-serán_files/figure-html/Asboot-1.png&#34; alt=&#34;Histograma y QQ-Plot de las estimaciones de la media de los datos de As con N = 1000 remuestreos&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 4: Histograma y QQ-Plot de las estimaciones de la media de los datos de As con N = 1000 remuestreos
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Bueno estimado lector, nos vemos pronto. Saludos.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;bibliografia&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Bibliografía&lt;/h1&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;Ghasemi A, Zahediasl S. Normality Tests for Statistical Analysis: A Guide for Non-Statisticians. &lt;em&gt;International Journal of Endocrinology and Metabolism&lt;/em&gt;. 2012;10(2):486-489. &lt;a href=&#34;doi:10.5812/ijem.3505&#34; class=&#34;uri&#34;&gt;doi:10.5812/ijem.3505&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Henry C. Thode &lt;em&gt;Testing For Normality&lt;/em&gt; CRC Press 2002&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&#34;http://bit.ly/2pfPsRg&#34;&gt;Is normality testing ‘essentially useless’?&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>¿Cuál es la máxima diferencia tolerable entre duplicados de análisis?</title>
      <link>https://www.analytical.cl/post/cual-maxima-diferencia-tolerable-entre-duplicados-analisis/</link>
      <pubDate>Mon, 28 Aug 2017 00:00:00 +0000</pubDate>
      
      <guid>https://www.analytical.cl/post/cual-maxima-diferencia-tolerable-entre-duplicados-analisis/</guid>
      <description>&lt;p&gt;Un día cualquiera en un laboratorio que aún no establece criterios de aceptación de precisión:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Duplicado 1 = 25.56 % Cu&lt;/li&gt;
&lt;li&gt;Duplicado 2 = 25.66 % Cu&lt;/li&gt;
&lt;li&gt;Diferencia = 0.10 % Cu&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;La diferencia observada ¿es aceptable para el laboratorio?&lt;/p&gt;
&lt;p&gt;Para responder a esta pregunta debemos considerar varias cosas:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;¿Los duplicados fueron realizados en condiciones de repetibilidad o reproducibilidad?&lt;/li&gt;
&lt;li&gt;¿Existe alguna normativa al respecto que se deba cumplir?&lt;/li&gt;
&lt;li&gt;¿Cuál es la metodología analítica? No es lo mismo determinar Cu en concentrado de cobre por electrogravimetría (método primario) que por Fluorescencia de Rayos X.&lt;/li&gt;
&lt;li&gt;¿Cuál es la incertidumbre del método analítico?&lt;/li&gt;
&lt;li&gt;¿Existe algún acuerdo a nivel comercial sobre estas diferencias?&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Para abordar este problema tendremos que hace la suposición que los duplicados fueron obtenidos en condiciones de repetibilidad, es decir: mismo analista, mismo día, mismo instrumento, etc. Bajo esta premisa hay varias formas de estimar la máxima diferencia tolerable entre duplicados de análisis.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Nota&lt;/strong&gt;: En realidad, los conceptos que mostraremos a continuación son completamente análogos para estimar la máxima diferencia tolerable en condiciones de reproducibilidad. Sin embargo, dedicaremos otro post a ese tema específico.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;El concepto estadístico clave para establecer la tolerancia entre duplicados es el límite de repetibilidad &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt;.&lt;/p&gt;
&lt;div id=&#34;limite-de-repetibilidad-r-iso-5725&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Límite de repetibilidad &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; ISO 5725&lt;/h1&gt;
&lt;p&gt;La guía ISO 5725 define el límite de repetibilidad &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; de la siguiente manera:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
r = 2.8\cdot s_{r}
\]&lt;/span&gt; y corresponde a la máxima diferencia, en valor absoluto, que puede tolerarse entre duplicados de análisis, obtenidos bajo condiciones de repetibilidad con un 95% de confianza. Veamos:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(s_{r}\)&lt;/span&gt; es la desviación estándar de repetibilidad, la cual da cuenta de la dispersión de las diferencias entre duplicados. Ya explicaremos cómo calcular este parámetro.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;El factor &lt;strong&gt;2.8&lt;/strong&gt;: aquí les exijo una prueba de fe mis hermanos, me tienen que creer porque si quieren la demostración, aumentaría mucho la viscosidad de este post . A &lt;em&gt;grosso modo&lt;/em&gt;, el factor 2.8 tiene que ver con el 95% de confianza, nos indica que cuando se establece la máxima diferencia tolerable, está permitido que el 5% de los duplicados estén fuera del límite &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt;, y aún el sistema analítico se encontraría bajo &lt;em&gt;Control Estadístico&lt;/em&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;como-obtenemos-la-precision-de-repetibilidad-s_r&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;¿Cómo obtenemos la precisión de repetibilidad &lt;span class=&#34;math inline&#34;&gt;\(s_{r}\)&lt;/span&gt;?&lt;/h1&gt;
&lt;p&gt;Existen varios métodos estadísticos para abordar la estimación de la desviación estándar de repetibililidad &lt;span class=&#34;math inline&#34;&gt;\(s_{r}\)&lt;/span&gt;, sin embargo, en este post nos enfocaremos en los dos más utilizados en química analítica:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;Estimación basada en el registro histórico de duplicados de análisis.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;La estimación mediante estudios de precisión siguiendo las directrices de la guía ISO 5725.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;No describiremos todos los detalles de cada uno de los diseños experimentales expuestos en estas guías, más bien, ejemplificaremos el cálculo de la desviación estándar de repetibilidad &lt;span class=&#34;math inline&#34;&gt;\(s_{r}\)&lt;/span&gt;:&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;metodo-de-estimacion-en-base-a-datos-historicos-de-duplicados&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Método de estimación en base a datos históricos de duplicados&lt;/h1&gt;
&lt;p&gt;Obviamente necesitamos crear una base de datos con los registros de análisis de muestras en duplicados en condiciones de repetibilidad. Estas muestras pueden corresponder a muestras de clientes, materiales de referencia primarios o secundarios, muestras control, etc. Lo importante es que ambos duplicados cumplan con las condiciones de repetibilidad. La tabla &lt;a href=&#34;#tab:bdsr&#34;&gt;1&lt;/a&gt; es un ejemplo de una base de datos a utilizar en este método:&lt;/p&gt;
&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
&lt;table class=&#34;table&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;caption&gt;
&lt;span id=&#34;tab:bdsr&#34;&gt;Table 1: &lt;/span&gt;Base de datos histórica de duplicados (sólo los primeros 6 datos)
&lt;/caption&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
ID
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
Duplicado 1
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
Duplicado 2
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
QAQC-01
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
30.79
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
30.54
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
QAQC-02
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
31.89
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
32.04
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
QAQC-03
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
31.28
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
31.32
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
QAQC-04
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
31.30
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
30.89
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
QAQC-05
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
30.70
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
30.66
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
QAQC-06
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
30.86
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
30.69
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Puede descargar esta base de datos desde este &lt;a href=&#34;https://1drv.ms/x/s!AuF6FPVWruwDtoUe9jzqyzQ_q1HFwg&#34;&gt;link&lt;/a&gt;. Y ahora la pregunta del millón: ¿Cuántas muestras en duplicado necesito? Si bien es posible obtener un cálculo “exacto” del número de muestras &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;, esto está fuera del alcance de este post. Sin embargo, podemos decir que &lt;span class=&#34;math inline&#34;&gt;\(n &amp;gt; 25\)&lt;/span&gt; es un número inicial adecuado.&lt;/p&gt;
&lt;p&gt;Una vez construida la base de datos, se puede obtener una estimación de &lt;span class=&#34;math inline&#34;&gt;\(s_{r}\)&lt;/span&gt; mediante la ecuación &lt;a href=&#34;#eq:srdup&#34;&gt;(1)&lt;/a&gt;:&lt;/p&gt;
&lt;span class=&#34;math display&#34; id=&#34;eq:srdup&#34;&gt;\[\begin{equation}
  s_{r} = \sqrt{\frac{\sum_{i = 1}^{n} (x_{i1} - x_{i2})^2}{2n}}
  \tag{1}
\end{equation}\]&lt;/span&gt;
&lt;p&gt;Esta ecuación puede ser fácilmente implementada en Excel pero en este post, como no, haremos los cálculos en lenguaje R. Pero antes, observe la figura &lt;a href=&#34;#fig:dup&#34;&gt;1&lt;/a&gt; la cual muestra un gráfico de dispersión entre Duplicado 1 (&lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt;) y Duplicado 2 (&lt;span class=&#34;math inline&#34;&gt;\(Y\)&lt;/span&gt;). En este caso el orden es irrelevante. Si ajustáramos un modelo lineal entre ambas variables ¿Qué valores de pendiente e intercepto deberíamos obtener?&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:dup&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/2017-08-28-cual-es-la-maxima-diferencia-tolerable-entre-duplicados-de-analisis_files/figure-html/dup-1.png&#34; alt=&#34;Gráfico de dispersión entre duplicados&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 1: Gráfico de dispersión entre duplicados
&lt;/p&gt;
&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;¡Correcto! Pendiente &lt;span class=&#34;math inline&#34;&gt;\(\beta_{1} = 1\)&lt;/span&gt; e intercepto &lt;span class=&#34;math inline&#34;&gt;\(\beta_{0} = 0\)&lt;/span&gt;. La línea roja representa esta recta teórica. Note también que la dispersión de los datos es constante en todo el rango de concentración, propiedad denominada &lt;strong&gt;Homocedasticidad&lt;/strong&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Esta propiedad es deseable, sin embargo, no todos los sistemas analíticos la poseen. En sí misma no es una problema, sin embargo, si la varibilidad de los duplicados aumenta con la concentración (&lt;em&gt;heterocedasticidad&lt;/em&gt;) tendremos que modelar esta variabilidad en función de la concentración en forma explícita o segmentar el rango, lo cual veremos en otro post.&lt;/p&gt;
&lt;p&gt;También advierta la presencia de datos alejados de la diagonal, es decir, diferencias entre duplicados grandes. ¿Qué hacemos con ellos?¿Los mantenemos o los eliminamos?&lt;/p&gt;
&lt;p&gt;Si los eliminamos, y realmente reflejaran la variabilidad del método, entonces subestimaríamos la máxima diferencia tolerable entre duplicados, aumentando la frecuencia de alertas de duplicados no conformes (nos ponemos la soga al cuello solitos). Si los mantenemos, y realmente fueron &lt;em&gt;errores&lt;/em&gt; puntuales de medición, sobreestimaríamos la tolerancia y la carta control sería de poca utilidad (mágicamente todos los datos caerían siempre dentro del los límites). Este tema lo abordaremos en otro post (llevo una lista).&lt;/p&gt;
&lt;p&gt;Como dato “anecdótico” en las operaciones de &lt;em&gt;trading&lt;/em&gt; en el mercado mundial de concentrado de cobre, la máxima diferencia tolerable entre resultados de distintos laboratorios (a.k.a exportador v/s importador) es 0,20 % Cu. Si la diferencia supera este límite, ambos negociadores se van a un arbitraje (multiplique 0,15 % Cu por la millones de toneladas que se transan en el mercado…a 3 US/libra no es un asunto trivial).&lt;/p&gt;
&lt;p&gt;Utilizando los datos históricos estimamos una desviación estándar de repetibilidad de &lt;span class=&#34;math inline&#34;&gt;\(s_{r} = 0.2\)&lt;/span&gt; % Cu. Por lo tanto, el límite de repetibilidad es obtenido de la ecuación &lt;a href=&#34;#eq:limr&#34;&gt;(2)&lt;/a&gt;:&lt;/p&gt;
&lt;span class=&#34;math display&#34; id=&#34;eq:limr&#34;&gt;\[\begin{eqnarray}
  r &amp;amp;=&amp;amp; 2.8\cdot s_{r} \\
  r &amp;amp;=&amp;amp; 2.8\cdot 0.2 \\
  r &amp;amp;=&amp;amp; 0.57\, \text{% Cu}
  \tag{2}
\end{eqnarray}\]&lt;/span&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;Interpretación&lt;/strong&gt;: La máxima diferencia tolerable, en valor absoluto, entre duplicados de análisis en condiciones de repetibilidad es &lt;span class=&#34;math inline&#34;&gt;\(r = 0.57\)&lt;/span&gt; % Cu.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Entonces, dados los datos iniciales:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Duplicado 1 = 25.56 % Cu&lt;/li&gt;
&lt;li&gt;Duplicado 2 = 25.66 % Cu&lt;/li&gt;
&lt;li&gt;Diferencia = 0.10 % Cu&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;La diferencia encontrada entre duplicados &lt;span class=&#34;math inline&#34;&gt;\(\Delta = 0.1 &amp;lt; 0.57\)&lt;/span&gt; % Cu, por lo tanto, se acepta la diferencia entre duplicados, es un dato de QAQC conforme.&lt;/p&gt;
&lt;p&gt;¿Y qué hacemos si no tenemos datos históricos de duplicados? Por favor, continue leyendo.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;estimacion-mediante-estudios-de-precision-siguiendo-las-directrices-de-la-guia-iso-5725&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Estimación mediante estudios de precisión siguiendo las directrices de la guía ISO 5725&lt;/h1&gt;
&lt;p&gt;Cuando no existen datos históricos, la guía ISO 5725 sugiere llevar a cabo un diseño experimental en el cual se estudien diversos factores que podrían, eventualmente, tener un efecto importante en la precisión del método analítico. Por ejemplo:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Analistas distintos&lt;/li&gt;
&lt;li&gt;Equipos de medición (cromatógrafos, AAS, etc.)&lt;/li&gt;
&lt;li&gt;Días distintos&lt;/li&gt;
&lt;li&gt;Etc.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;El “problema” de esta aproximación es que a medida que crece el número de factores, el tamaño del diseño experimental (a.k.a número de experientos) crece en forma rápida incluso, en algunos diseños, en forma exponencial.&lt;/p&gt;
&lt;p&gt;La ventaja de este método es que permite estimar en un único estudio la precisión de repetibilidad, reproducibilidad y la precisión intermedia, es decir, entre-analistas, entre-equipos, etc. La otra ventaja es que permite estimar los denominados componentes de varianza “¿Y?” – se preguntará. Bueno, los componentes de varianza nos indican cuál es el factor que más aporta a la variabilidad del sistema analítico ¿será la variabilidad entre-analistas? ¿o los distintos equipos que dispone el laboratorio? De esta forma Ud. podrá focalizar los esfuerzos y recursos en mejorar la precisión del método sólo en aquellos factores que más aporten a la variabilidad total.&lt;/p&gt;
&lt;p&gt;Veamos en qué consiste este método de estimación de precisión en base al estudio del factor &lt;strong&gt;Analista&lt;/strong&gt;. Existen varios diseños experimentales para evaluar este factor, sin embargo, en este post comenzaremos con algo &lt;em&gt;light&lt;/em&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Estimaremos la precisión de reptibilidad y reproducibilidad del método volumétrico para la determinación de Cu en concentrado de cobre, en un laboratorio donde &lt;span class=&#34;math inline&#34;&gt;\(n = 4\)&lt;/span&gt; analistas son igualmente competentes para llevar a cabo el análisis, siguiendo el mismo instructivo.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Para abordar este objetivo, proponemos el siguiente diseño experimental:&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;https://www.analytical.cl/img/doe.png&#34; alt=&#34;Diseño Experimental&#34; width=&#34;700&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;Diseño Experimental&lt;/p&gt;
&lt;/div&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Una única muestra será analizada por los &lt;span class=&#34;math inline&#34;&gt;\(n = 4\)&lt;/span&gt; analistas.&lt;/li&gt;
&lt;li&gt;Cada analista realizará el análisis en quintuplicado &lt;span class=&#34;math inline&#34;&gt;\(j = 5\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;Los &lt;span class=&#34;math inline&#34;&gt;\(k = n\cdot j = 20\)&lt;/span&gt; análisis deben ser obtenidos en condiciones de repetibilidad&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Si bien podríamos publicar una enciclopedia de posts sobre diseño experimental en química, surgen algunas preguntas sobre este diseño en particular:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;¿Por qué una única muestra? Porque si cada analista recibiera una muestra distinta, entonces la precisión del factor analista estaría “contaminada” con la variabilidad entre muestras, la cual no nos interesa en este estudio.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;¿Y si una única muestra no es suficiente para llevar a cabo los 20 análisis? Existen otros diseños experimentales denominados &lt;em&gt;anidados&lt;/em&gt; que permiten estimar la precisión utilizando muestras distintas.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;¿Por qué los análisis de cada analista deben ser obtenidos en condiciones de repetibilidad? Porque no queremos que otro factor no controlado (por ejemplo, equipos distintos) influya en la estimación de la precisión entre-analistas.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;En lo posible, aumente el número de analistas en vez de hacer muchos replicados. Es mejor 5 analistas en triplicado, que 3 en quintuplicado.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;“La” muestra podría corresponder a una muestra del cliente. No es necesario que sea un material de referencia, sin embargo, esta muestra debe ser lo suficientemente homogénea… ¡Ah, eso es trampa! ¿Cómo demostramos que la muestra es homogénea? Le doy un dato, anote:&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;Si su muestra es material particulado, le tengo malas noticias: No existen las muestras homogéneas de este tipo de material (gracias a san Pierre Gy por el dato).&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Como mencionamos anteriormente podríamos postear &lt;em&gt;ad infinitum&lt;/em&gt; sobre diseño de exprimentos en química, sin embargo, la banda ancha es finita así que vamos al grano. La tabla &lt;a href=&#34;#tab:doe&#34;&gt;2&lt;/a&gt; muestra los datos experimentales del estudio de precisión propuesto:&lt;/p&gt;
&lt;table&gt;
&lt;caption&gt;
&lt;span id=&#34;tab:doe&#34;&gt;Table 2: &lt;/span&gt;Resultados de estudio de precisión [% Cu]
&lt;/caption&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
Replicado
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
Analista 1
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
Analista 2
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
Analista 3
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
Analista 4
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
1
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
24.74
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
24.73
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
25.06
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
25.00
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
2
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
25.06
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
25.16
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
25.17
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
24.98
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
3
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
25.34
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
24.98
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
25.24
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
24.79
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
4
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
25.28
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
25.11
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
24.80
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
24.65
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
5
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
25.02
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
24.72
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
25.11
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
24.82
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Antes de llevar a cabo el análisis estadístico formal, observemos la figura &lt;a href=&#34;#fig:doeplot&#34;&gt;2&lt;/a&gt; la cual muestra el valor promedio de cada analista &lt;span class=&#34;math inline&#34;&gt;\(\pm\)&lt;/span&gt; 1 desviación estándar. Ella nos indica que, aparentemente, los resultados entre los analistas son bastante consistentes.&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:doeplot&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/2017-08-28-cual-es-la-maxima-diferencia-tolerable-entre-duplicados-de-analisis_files/figure-html/doeplot-1.png&#34; alt=&#34;Boxplot estudio de precisión&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 2: Boxplot estudio de precisión
&lt;/p&gt;
&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;Ahora bien ¿Cómo, entonces, estimamos la precisión de repetibilidad y reproducibilidad a partir de la tabla &lt;a href=&#34;#tab:doe&#34;&gt;2&lt;/a&gt;? Fácil, con el todopoderoso Análisis de Varianza (ANOVA).&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;No detallaremos la matemática detrás de esta poderosa técnica, sin embargo, diremos simplemente que el ANOVA es un método cuyo propósito es particionar la variabilidad total de un conjunto de datos en componentes que intentan explicarla. Aplicada a nuestro caso, utilizaremos ANOVA para particionar la variabilidad total de los 20 resultados de % Cu entre dos componentes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;El factor analista&lt;/li&gt;
&lt;li&gt;La repetiblidad del método analítico.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;para lo cual seguiremos paso a paso las instrucciones de la guía ISO 5725. En primer lugar obtendremos la tabla ANOVA mediante lenguaje &lt;code&gt;R&lt;/code&gt;:&lt;/p&gt;
&lt;table&gt;
&lt;caption&gt;
&lt;span id=&#34;tab:aov&#34;&gt;Table 3: &lt;/span&gt;Tabla ANOVA precisión
&lt;/caption&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Origen Variación
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
g.l
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
SQ
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
MS
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
F calculado
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
p-value
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
analista
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
3
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.2
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.07
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
1.8
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.19
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Residuals
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
16
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.6
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.04
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Las tablas ANOVA muy similares en casi todos los softwares estadísticos profesionales… y en Excel también. Entonces:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Repetibilidad &lt;span class=&#34;math inline&#34;&gt;\(s_{r}\)&lt;/span&gt;: Es simplemente la raíz cuadrada del término &lt;span class=&#34;math inline&#34;&gt;\(MS\)&lt;/span&gt; de los &lt;strong&gt;Residuos&lt;/strong&gt;. En la nomenclatura de ANOVA es lo que se conoce como variabilidad dentro (&lt;em&gt;within&lt;/em&gt;). Para los datos de la tabla &lt;a href=&#34;#tab:doe&#34;&gt;2&lt;/a&gt; se obtiene &lt;span class=&#34;math inline&#34;&gt;\(s_{r} = \sqrt{\text{MS}_{Residuals}} = \sqrt{0.04} = 0.19\)&lt;/span&gt; % Cu.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Precisión intermedia o variabilidad entre-analistas &lt;span class=&#34;math inline&#34;&gt;\(s_{analista}\)&lt;/span&gt;: ¡No tan rápido! No es la raíz cuadrada de &lt;span class=&#34;math inline&#34;&gt;\(MS\)&lt;/span&gt; del factor analista. Debemos hacer el siguiente cálculo adicional:&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;span class=&#34;math display&#34;&gt;\[\begin{eqnarray}
  s_{analista} &amp;amp;=&amp;amp; \sqrt{\frac{MS_{analista} - MS_{Residuals}}{j}} \\
  s_{analista} &amp;amp;=&amp;amp; \sqrt{\frac{0.07 - 0.04}{5}} \\
  s_{analista} &amp;amp;=&amp;amp; 0.08\, \text{% Cu} 
\end{eqnarray}\]&lt;/span&gt;
&lt;p&gt;donde &lt;span class=&#34;math inline&#34;&gt;\(j = 5\)&lt;/span&gt; es el número de replicados que hizo cada analista&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Reproducibilidad &lt;span class=&#34;math inline&#34;&gt;\(s_{R}\)&lt;/span&gt;: Es simplemente la combinación en cuadratura de las precisiones arriba calculadas.&lt;/li&gt;
&lt;/ul&gt;
&lt;span class=&#34;math display&#34;&gt;\[\begin{eqnarray}
  s_{R} &amp;amp;=&amp;amp; \sqrt{s_{r}^{2} + s_{analista}^2}\\
  s_{R} &amp;amp;=&amp;amp; 0.21\, \text{% Cu}
\end{eqnarray}\]&lt;/span&gt;
&lt;p&gt;Por lo tanto, con estos datos podemos calcular el límite de repetibilidad sin necesidad de tener una base de datos histórica de duplicados. En este caso &lt;span class=&#34;math inline&#34;&gt;\(r = 2.8 s_{r} = 0.58\)&lt;/span&gt; % Cu.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;¿Y si quisiera establecer la máxima diferencia tolerable entre analistas?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Nos vemos en el siguiente post.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;bonus-track-breve-historia-del-factor-2.8&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;&lt;em&gt;Bonus track&lt;/em&gt; : Breve historia del factor 2.8&lt;/h1&gt;
&lt;p&gt;Sea &lt;span class=&#34;math inline&#34;&gt;\(x_{1}\)&lt;/span&gt; y &lt;span class=&#34;math inline&#34;&gt;\(x_{2}\)&lt;/span&gt; los duplicados de análisis 1 y 2, respectivamente. Cada uno de ellos “sigue” una distribución Normal con media &lt;span class=&#34;math inline&#34;&gt;\(\mu\)&lt;/span&gt; y varianza &lt;span class=&#34;math inline&#34;&gt;\(V = \sigma_{r}^2\)&lt;/span&gt; y, además, entre ellos son &lt;em&gt;independientes&lt;/em&gt;, entonces se cumple lo siguiente:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;la diferencia entre duplicados &lt;span class=&#34;math inline&#34;&gt;\(\Delta = x_{1} - x_{2}\)&lt;/span&gt; sigue una distribución Normal con media 0 y varianza &lt;span class=&#34;math inline&#34;&gt;\(V_{\Delta} = V(x_{1} - x_{2}) = V(x_{1}) + V(x_{2}) = 2\sigma_{r}^2\)&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Si la varianza de las diferencias es &lt;span class=&#34;math inline&#34;&gt;\(V_{\Delta} = 2\sigma_{r}^2\)&lt;/span&gt;, entonces la desviación estándar es &lt;span class=&#34;math inline&#34;&gt;\(\sqrt{2} \sigma_{r}\)&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Por lo tanto, si quisiéramos construir un intervalo de confianza al 95% para la diferencia entre duplicados obtendríamos &lt;span class=&#34;math inline&#34;&gt;\(\Delta \pm 2\sqrt{2} \sigma_{r}\)&lt;/span&gt;. El 2 es por que para una distribución Normal se sabe que entre la media &lt;span class=&#34;math inline&#34;&gt;\(\pm\)&lt;/span&gt; 2 la desviación estándar se encuentran aproximadamente el 95% de las observaciones.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(s_{r}\)&lt;/span&gt; es la estimación de &lt;span class=&#34;math inline&#34;&gt;\(\sigma_{r}\)&lt;/span&gt;, la cual es fija pero desconocida.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Como &lt;span class=&#34;math inline&#34;&gt;\(\sqrt{2}\approx 1,41\)&lt;/span&gt; entonces, con un 95% de confianza, la diferencia se encuentra entre &lt;span class=&#34;math inline&#34;&gt;\(\Delta \pm 2\cdot 1,41 \cdot s_{r} = 2.8\cdot s_{r}\)&lt;/span&gt;. Ahora imágineme como el mago Tamariz al final de sus actos tocando el violín ¡chiararaaá! (Si eres &lt;em&gt;old school&lt;/em&gt; sabrás quien es el mago Tamariz. Si eres &lt;em&gt;millenial&lt;/em&gt; mira este &lt;a href=&#34;https://www.youtube.com/watch?v=zcSqG2v-MZQ&#34;&gt;video&lt;/a&gt;).&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div id=&#34;bibliografia&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Bibliografía&lt;/h1&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;ISO 5725 – 3:1994 Accuracy (trueness and precision) of measurement methods and results – Part 3: Intermediate measures of the precision of a standard measurement method&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Michael Thompson, Bertil Magnusson Methodology in internal quality control of chemical analysis &lt;em&gt;Accreditation and Quality Assurance August 2013, Volume 18, Issue 4, pp 271–278&lt;/em&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>¿Cómo &#34;demuestro&#34; que mi curva de calibracion es lineal?</title>
      <link>https://www.analytical.cl/post/como-demuestro-que-mi-curva-de-calibracion-es-lineal/</link>
      <pubDate>Wed, 23 Aug 2017 00:00:00 +0000</pubDate>
      
      <guid>https://www.analytical.cl/post/como-demuestro-que-mi-curva-de-calibracion-es-lineal/</guid>
      <description>&lt;!-- Promedín: Lo siento, no se puede demostrar eso. Fin del Post.\ --&gt;
&lt;!-- Preguntín: &#34;¡Pero cómo!... si el r = 0,999&#34;&#34; \ --&gt;
&lt;!-- Promedín: Lo lamento, el coeficiente de correlación no es una prueba formal de linealidad. --&gt;
&lt;p&gt;En este post intentaremos derribar el mito del coeficiente de correlación con “muchos” 9’s como prueba de linealidad. Además, presentaremos dos test formales para evaluar el modelo de calibración lineal en química analítica.&lt;/p&gt;
&lt;div id=&#34;coeficiente-de-correlacion&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Coeficiente de correlación&lt;/h1&gt;
&lt;p&gt;Este parámetro estadístico indica la fuerza y dirección de la relación de dos variables cuantitativas, por ejemplo;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Concentración (&lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;) y Absorbancia (&lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt;)&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(log \text{ Concentración}\)&lt;/span&gt; y &lt;span class=&#34;math inline&#34;&gt;\(E\)&lt;/span&gt; Potencial (Ecuación de Nernst)&lt;/li&gt;
&lt;li&gt;La edad de las ganadoras de Miss América con los asesinatos utilizando objetos calientes y vapor. ¡Cuidado con las correlaciones &lt;a href=&#34;http://tylervigen.com/spurious-correlations&#34;&gt;espurias&lt;/a&gt;!&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Todos los químicos estamos familiarizados con la ecuación de Lambert-Beer, la cual establece la archiconocida relación entre absorbancia y concentración en métodos espectrofotométricos:&lt;/p&gt;
&lt;span class=&#34;math display&#34; id=&#34;eq:lambert&#34;&gt;\[\begin{equation}
  \underbrace{A}_\text{y} = \underbrace{\epsilon \cdot b}_\text{$\beta_{1}$} \cdot
  \underbrace{C}_\text{x}
    \tag{1}
\end{equation}\]&lt;/span&gt;
&lt;p&gt;De la ecuación &lt;a href=&#34;#eq:lambert&#34;&gt;(1)&lt;/a&gt; se observa claramente la relación con el modelo estándar de calibración lineal &lt;span class=&#34;math inline&#34;&gt;\(y = \beta_{0} + \beta_{1}x\)&lt;/span&gt; asumiendo un intercepto &lt;span class=&#34;math inline&#34;&gt;\(\beta_{0} = 0\)&lt;/span&gt;. Por lo tanto ¿por qué nos sorprende tanto encontrar un coeficiente de correlación alto en curvas de calibración espectrofotométricas? Era totalmente esperable, pues hay un modelo físico-químico que sustenta el modelo lineal.&lt;/p&gt;
&lt;p&gt;OK, de acuerdo. Este modelo físico-químico sólo es válido bajo ciertas condiciones (como todos los modelos), de hecho son conocidas las desviaciones de la ley de Lambert-Beer a altas concentraciones.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;derribando-el-mito-del-r-0999&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Derribando el mito del r = 0,999…&lt;/h1&gt;
&lt;p&gt;Para comenzar, por favor, ponga atención a la figura &lt;a href=&#34;#fig:anscombe&#34;&gt;1&lt;/a&gt; denominada “El Cuarteto de Anscombe”. La “gracia” de estos datos de calibración es que todos tienen la misma pendiente, intercepto, error de calibración y… ¡coeficiente de correlación!&lt;/p&gt;
&lt;p&gt;¿No me cree? Le dejo este &lt;a href=&#34;https://1drv.ms/x/s!AuF6FPVWruwDtfpb0dC8SSaBCChfzA&#34;&gt;link&lt;/a&gt; para que descargue los datos en archivo Excel y se convenza con sus propios ojos.&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:anscombe&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/2017-08-23-como-demuestro-que-mi-curva-de-calibracion-es-lineal_files/figure-html/anscombe-1.png&#34; alt=&#34;El Cuarteto de Ascombe&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 1: El Cuarteto de Ascombe
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;El punto que revela la figura &lt;a href=&#34;#fig:anscombe&#34;&gt;1&lt;/a&gt; es que es posible obtener coeficientes de correlación “altos” inclusive con datos que, a simpe vista, no revelan una relación lineal entre &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt; e &lt;span class=&#34;math inline&#34;&gt;\(Y\)&lt;/span&gt;. Es más, es posible obtener un alto coeficiente de correlación donde no existe absolutamente ninguna correlación entre &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt; e &lt;span class=&#34;math inline&#34;&gt;\(Y\)&lt;/span&gt; mediante un mal de diseño de la curva de calibración. Por ejemplo, en la figura &lt;a href=&#34;#fig:influyente&#34;&gt;2&lt;/a&gt; se muestra a la izquierda que la correlación entre &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; e &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt; es prácticamente 0. Sin embargo, cuando incluimos un punto &lt;em&gt;influyente&lt;/em&gt;, muy alejado de la nube de puntos a baja concentración, mágicamente el r = 1 (derecha).&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;Moraleja:&lt;/em&gt; Trate, en lo posible, de diseñar la curva con los puntos equiespaciados y evite los saltos de varios órdenes de magnitud de la concentración.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:influyente&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/2017-08-23-como-demuestro-que-mi-curva-de-calibracion-es-lineal_files/figure-html/influyente-1.png&#34; alt=&#34;Punto inlfuyente en la calibración&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 2: Punto inlfuyente en la calibración
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;La linealidad tampoco es un parámetro cuantitativo, una curva con r = 0,999 no es más lineal que otra con r = 0,99. Observe la figura &lt;a href=&#34;#fig:simplot&#34;&gt;3&lt;/a&gt;, ambas curvas fueron simuladas en lenguaje &lt;code&gt;R&lt;/code&gt; con el mismo intercepto y pendiente siguiendo estrictamente el modelo lineal &lt;span class=&#34;math inline&#34;&gt;\(y = \beta_{0} + \beta_{1}x\)&lt;/span&gt;, sin embargo, tienen coeficientes de correlación distintos. La curva de la izquierda no es más lineal que la de la derecha ya que ambas fueron simuladas a partir del mismo modelo, la única diferencia es que la de la derecha tiene una mayor dispersión de los puntos, pero no por ello es “menos lineal”, de hecho ambas lo son, pues fueron simuladas.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;set.seed(123) # Es para que Ud. obtenga los mismos 
              # resultados en su simulación en R
              

b0 &amp;lt;- 1  # Intercepto = 1
b1 &amp;lt;- 10 # Pendiente = 10
s &amp;lt;- 1   # Desviación estándar de calibración

# Simulamos el mismo modelo lineal 
x &amp;lt;- 1:10 # Calibrantes
y1 &amp;lt;- b0 + b1*x + rnorm(10, 0, s) # Absorbancias con 
                                  # error = s = 1
y2 &amp;lt;- b0 + b1*x + rnorm(10, 0, 10*s) # Absorbancias con 
                                     # error = 10*s = 10&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:simplot&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/2017-08-23-como-demuestro-que-mi-curva-de-calibracion-es-lineal_files/figure-html/simplot-1.png&#34; alt=&#34;Simulación de curvas perfectamente lineales&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 3: Simulación de curvas perfectamente lineales
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;test-formales-de-linealidad&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Test formales de linealidad&lt;/h1&gt;
&lt;p&gt;Existen varios tests estadísticos formales para evaluar el supuesto de linealidad de la curva de calibración. Sin embargo, en este post veremos dos que son los más utilizados en Química Analítica y son sugeridos por normativas internacionales (para presentárselos a los amables auditores).&lt;/p&gt;
&lt;p&gt;Si bien no es estrictamente riguroso, para simplificar el concepto, diremos que ambos tests estadísticos intentan dirimir entre dos hipótesis:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(H_{0}\)&lt;/span&gt; (a.k.a Hipótesis Nula) : El modelo lineal es adecuado para describir los datos de calibración&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(H_{1}\)&lt;/span&gt; (a.k.a Hipótesis alternativa): El modelo lineal &lt;strong&gt;NO&lt;/strong&gt; es adecuado para describir los datos de calibración&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;También debemos hacer la siguiente acotación: En &lt;strong&gt;estadística&lt;/strong&gt; un modelo lineal es aquel en que sus parámetros son lineales. Por ejemplo, la curva de calibración lineal clásica &lt;span class=&#34;math inline&#34;&gt;\(y = \beta_{0} + \beta_{1}x\)&lt;/span&gt; tanto &lt;span class=&#34;math inline&#34;&gt;\(\beta_{0}\)&lt;/span&gt; y &lt;span class=&#34;math inline&#34;&gt;\(\beta_{1}\)&lt;/span&gt; son lineales. Sin embargo, en un modelo exponencial &lt;span class=&#34;math inline&#34;&gt;\(y = \gamma_{0} e^{\gamma_{1}x}\)&lt;/span&gt; el coeficiente &lt;span class=&#34;math inline&#34;&gt;\(\gamma_{1}\)&lt;/span&gt; no lo es.&lt;/p&gt;
&lt;p&gt;Dicho esto, el modelo cuadrático de calibración &lt;span class=&#34;math inline&#34;&gt;\(y = \beta_{0} + \beta_{1}x + \beta_{2}x^2\)&lt;/span&gt; &lt;strong&gt;es lineal&lt;/strong&gt; desde el punto de vista estrictamente estadístico. Sin embargo, debido al arraigo del concepto de linealidad en química analítica no modificaremos su interpretación.&lt;/p&gt;
&lt;div id=&#34;test-de-carencia-de-ajuste-lack-of-fit-iso-11095&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Test de carencia de ajuste (&lt;em&gt;Lack of fit&lt;/em&gt;) ISO 11095&lt;/h2&gt;
&lt;p&gt;Este test está basado en comparar dos estimadores del error aleatorio:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Error puro o experimental&lt;/li&gt;
&lt;li&gt;Error de carencia de ajuste o &lt;em&gt;lack of fit&lt;/em&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Es decir, necesitamos un estimador del error aleatorio totalmente independiente del error del modelo de calibración que queremos ajustar. Para estimar este error, la prueba de carencia de ajuste exige que hagamos replicados de cada uno de los calibrantes.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Pero tienen que ser replicados verdaderos. No es válido inyectar varias veces el mismo estándar en el equipo. Prepárelos independientemente.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Si los dos estimadores del error aleatorio son similares, entonces el modelo de calibración que acabamos de ajustar es adecuado para modelar los datos experimentales. ¿Cuán similares tienen que ser? Lo probaremos con un test F. Los detalles algebraicos son latosos-engorrosos y pueden ser consultados en la bibliografía. Sólo indicaremos cómo hacer este test de linealidad en lenguaje &lt;code&gt;R&lt;/code&gt;, como no. (¿Y en Excel cuándo?)&lt;/p&gt;
&lt;p&gt;La tabla &lt;a href=&#34;#tab:lof&#34;&gt;1&lt;/a&gt; muestra los datos de calibración de cloranfenicol en matriz leche obtenida por GC/MS-NCI (&lt;em&gt;Gas Chromatography/Mass Spectrometry - Negative Chemical Ionization&lt;/em&gt; …¡Qué tiempos aquellos!). Note que cada nivel de calibración está preparado en triplicado totalizando n = 15 calibrantes independientes. La figura &lt;a href=&#34;#fig:lofplot&#34;&gt;4&lt;/a&gt; muestra la curva de calibración.&lt;/p&gt;
&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
&lt;table class=&#34;table&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;caption&gt;
&lt;span id=&#34;tab:lof&#34;&gt;Table 1: &lt;/span&gt;Calibración CAF [ug/kg]
&lt;/caption&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
Replicado
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
0
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
0.25
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
0.5
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
0.75
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
1
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
1
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
88
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
7714
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
15292
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
22611
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
30280
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
2
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
154
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
7726
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
14947
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
22945
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
30222
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
3
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
512
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
8043
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
15063
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
22772
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
30089
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:lofplot&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/2017-08-23-como-demuestro-que-mi-curva-de-calibracion-es-lineal_files/figure-html/lofplot-1.png&#34; alt=&#34;Curva de calibración CAF. Test de carencia de ajuste&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 4: Curva de calibración CAF. Test de carencia de ajuste
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;La tabla &lt;a href=&#34;#tab:lofcal&#34;&gt;2&lt;/a&gt; muestra el análisis estadístico de esta calibración:&lt;/p&gt;
&lt;!-- Ancho de las tabla --&gt;
&lt;style type=&#34;text/css&#34;&gt;
.table {

    width: 100%;
    
}
&lt;/style&gt;
&lt;table&gt;
&lt;caption&gt;
&lt;span id=&#34;tab:lofcal&#34;&gt;Table 2: &lt;/span&gt;Pendiente e intercepto de calibración
&lt;/caption&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
term
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
estimate
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
std.error
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
statistic
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
p.value
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
(Intercept)
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
262
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
78
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.005
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
x.caf
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
29936
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
127
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
236
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.000
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Por ahora no nos detendremos en el análisis de la tabla (eso quedará para otro post). Haremos directamente el Test de Carencia de Ajuste (&lt;em&gt;lack of fit&lt;/em&gt;) en &lt;code&gt;R&lt;/code&gt; el cual se muestra en la tabla &lt;a href=&#34;#tab:loftest&#34;&gt;3&lt;/a&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(alr3) # Cargamos el package &amp;#39;alr3&amp;#39;
pureErrorAnova(fit.cal)&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;caption&gt;
&lt;span id=&#34;tab:loftest&#34;&gt;Table 3: &lt;/span&gt;Tabla de test Carencia de Ajuste
&lt;/caption&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Df
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Sum Sq
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Mean Sq
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
F value
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Pr(&amp;gt;F)
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
x.caf
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1680303154
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1680303154
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
54131
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Residuals
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
392486
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
30191
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Lack of fit
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
82074
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
27358
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.48
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Pure Error
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
310412
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
31041
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Ok, para interpretar el test de carencia de ajuste nos fijaremos en la fila que dice “&lt;em&gt;Lack of fit&lt;/em&gt;” y en el &lt;em&gt;p-value&lt;/em&gt; del test, el cual aparece bajo la columna &lt;em&gt;Pr(&amp;gt;F)&lt;/em&gt; = 0.48. La interpretación tradicional de una prueba estadística diría algo más o menos así:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Dado que el &lt;em&gt;p-value&lt;/em&gt; &lt;span class=&#34;math inline&#34;&gt;\(&amp;gt; 0.05\)&lt;/span&gt;, entonces, no hay evidencias en contra de la hipótesis nula. El modelo lineal es adecuado para modelar los datos de calibración.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Algunas consideraciones:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;¿Dice en alguna parte que el modelo de calibración es lineal? Póngalo de &lt;em&gt;wallpaper&lt;/em&gt; en su pantalla: &lt;strong&gt;NO&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;Lo único que se puede extraer como conclusión es que el modelo lineal es adecuado, es razonable para modelar los datos de calibración. Nada más.&lt;/li&gt;
&lt;li&gt;Existen infinitos modelos de calibración que podrían ser idóneos, este test nos dice si el que hemos elegido para modelar los datos es razonable/adecuado, sin embargo, no nos dice que sea “EL” modelo perfecto.&lt;/li&gt;
&lt;li&gt;¿Qué tiene de especial el famoso 0,05? Absolutamente &lt;em&gt;NADA&lt;/em&gt;. ¿Qué concluiría Ud. si el &lt;em&gt;p-value&lt;/em&gt; fuese 0,04999 ó 0,05001? Sería un test totalmente inconcluyente.&lt;/li&gt;
&lt;li&gt;Lamentablemente, esto es una dicotomía perversa que desde hace mucho tiempo ha sido objeto de varias críticas. Le invito a leer las siguientes referencias sobre la interpretación y controversia de los &lt;em&gt;p-values&lt;/em&gt; en ciencia:&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Ronald L. Wasserstein &amp;amp; Nicole A. Lazar (2016) The ASA’s Statement on p-Values: Context, Process, and Purpose &lt;em&gt;The American Statistician Volume 70, 2016 - Issue 2&lt;/em&gt; &lt;a href=&#34;http://amstat.tandfonline.com/doi/abs/10.1080/00031305.2016.1154108&#34;&gt;link&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;M.Baker Statisticians issue warning over misuse of P values &lt;em&gt;Nature &lt;strong&gt;531&lt;/strong&gt;, 151 (10 March 2016)&lt;/em&gt; &lt;a href=&#34;http://www.nature.com/news/statisticians-issue-warning-over-misuse-of-p-values-1.19503&#34;&gt;link&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Singh Chawla D. Big names in statistics want to shake up much-maligned P value. &lt;em&gt;Nature. 2017 Jul 26;548(7665):16-17&lt;/em&gt; &lt;a href=&#34;https://www.nature.com/news/big-names-in-statistics-want-to-shake-up-much-maligned-p-value-1.22375?beta=false&#34;&gt;link&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;“The p-value was never intended to be a substitute for scientific reasoning” Ron Wasserstein, Director Ejecutivo de la Asociación Americana de Estadística ASA.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;div id=&#34;test-de-mandel-iso-8466-1&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Test de Mandel ISO 8466-1&lt;/h2&gt;
&lt;p&gt;Esta prueba estadística es bastante sencilla y está basada en la comparación entre el modelo de calibración lineal y un modelo alternativo. Por lo tanto, no es una prueba absoluta, sino relativa a la elección del modelo alternativo. Require al menos n = 6 calibrantes (sin replicado).&lt;/p&gt;
&lt;p&gt;En general, el test de Mandel utiliza el modelo de calibración cuadrático para compararlo con el modelo lineal:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[ y = \beta_{0} + \beta_{1}x + \beta_{2}x^2\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Los detalles estadísticos pueden consultarse en la bibliografía.&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Primero calcule la suma de cuadrados de los residuos &lt;span class=&#34;math inline&#34;&gt;\(SS_{r}\)&lt;/span&gt; para cada uno de los modelos de acuerdo a la siguiente expresión:&lt;/li&gt;
&lt;/ol&gt;
&lt;span class=&#34;math display&#34; id=&#34;eq:res&#34;&gt;\[\begin{equation}
  SS_{r} = \sum_{i = 1}^{n} e_{i}^2
    \tag{2}
\end{equation}\]&lt;/span&gt;
&lt;p&gt;Donde el residuo &lt;span class=&#34;math inline&#34;&gt;\(e = y - \hat{y}\)&lt;/span&gt;. &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt; es la respuesta instrumental observada o experimental (áreas, absorbancias, etc.); &lt;span class=&#34;math inline&#34;&gt;\(\hat{y}\)&lt;/span&gt;, es la respuesta instrumental que predice el modelo (lineal o o cuadrático) en cada una de las concentraciones de los calibrantes. Si observa la ecuación &lt;a href=&#34;#eq:res&#34;&gt;(2)&lt;/a&gt; el concepto de residuo es el mismo para cualquier modelo de calibración, es decir, ¿cuánto difiere lo que se observa experimentalmente con lo que predice el modelo?&lt;/p&gt;
&lt;p&gt;Un buen modelo tiene residuos pequeños. Un residuo grande para cierto de nivel de concentración implica que existe una gran diferencia entre lo observado y lo que predice el modelo, por lo tanto, nos guiará (en otro post) a detectar posibles valores anómalos o &lt;em&gt;outliers&lt;/em&gt;.&lt;/p&gt;
&lt;ol start=&#34;2&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Calcule la diferencia entre ambas sumas de cuadrado de los residuos, la del modelo no lineal &lt;span class=&#34;math inline&#34;&gt;\(SS_{r}^{no-lin}\)&lt;/span&gt; y la correspondiente al modelo lineal &lt;span class=&#34;math inline&#34;&gt;\(SS_{r}^{lin}\)&lt;/span&gt;:&lt;/li&gt;
&lt;/ol&gt;
&lt;span class=&#34;math display&#34; id=&#34;eq:D&#34;&gt;\[\begin{equation}
  D = SS_{r}^{no-lin} -  SS_{r}^{lin}
  \tag{3}
\end{equation}\]&lt;/span&gt;
&lt;ol start=&#34;3&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Estime el estadístico F calculado:&lt;/li&gt;
&lt;/ol&gt;
&lt;span class=&#34;math display&#34; id=&#34;eq:D&#34;&gt;\[\begin{equation}
  F = \frac{D}{SS_{r}^{no-lin}/(n - 3)}
  \tag{3}
\end{equation}\]&lt;/span&gt;
&lt;ol start=&#34;3&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;Obtenga el F de tabla para 1 grado de libertad en el numerador y &lt;span class=&#34;math inline&#34;&gt;\(n - 3\)&lt;/span&gt; para el denominador&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Compare el &lt;span class=&#34;math inline&#34;&gt;\(F_{calculado}\)&lt;/span&gt; con el &lt;span class=&#34;math inline&#34;&gt;\(F_{tabla}\)&lt;/span&gt; y decida en base a la siguiente regla:&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Si &lt;span class=&#34;math inline&#34;&gt;\(F_{calculado} &amp;lt; F_{tabla}\)&lt;/span&gt; se concluye que no hay evidencias en contra de la hipótesis nula de linealidad del modelo. ¿Quiere decir que el modelo de calibración es exactamente lineal? Ya sabemos que &lt;strong&gt;NO&lt;/strong&gt;. Rigen las mismas consideraciones que que notamos en el test de carencia de ajuste.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Si &lt;span class=&#34;math inline&#34;&gt;\(F_{calculado} &amp;gt; F_{tabla}\)&lt;/span&gt; se rechaza la hipótesis nula de linealidad del modelo. Los datos no son consistentes con la hipótesis. Y aquí se abre una caja de Pandora, pues esta conclusión también tiene muchas consideraciones estadísticas que se deben tener en cuenta para interpretarla apropiadamente las cuales, por ahora, no profundizaremos.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Los pasos recién descritos son para llevar a cabo el Test de Mandel “a mano”, afortunadamente los softwares estadísticos como &lt;code&gt;R&lt;/code&gt; y Excel (sí ¡Excel!) tienen incorporada esta prueba estadística de linealidad. Veamos un ejemplo.&lt;/p&gt;
&lt;p&gt;La tabla &lt;a href=&#34;#tab:datamandel&#34;&gt;4&lt;/a&gt; muestra los datos de calibración de Cu por AAS; la figura &lt;a href=&#34;#fig:plotmandel&#34;&gt;5&lt;/a&gt;, la curva de calibración:&lt;/p&gt;
&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
&lt;table class=&#34;table&#34; style=&#34;width: auto !important; text-align: right;&#34;&gt;
&lt;caption&gt;
&lt;span id=&#34;tab:datamandel&#34;&gt;Table 4: &lt;/span&gt;Curva de Calibración Cu
&lt;/caption&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
0
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
10
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
20
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
30
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
40
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
50
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
60
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
70
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
80
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
90
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
100
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
-0.007
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.071
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.146
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.212
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.274
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.334
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.385
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.43
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.473
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.511
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.546
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:plotmandel&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/2017-08-23-como-demuestro-que-mi-curva-de-calibracion-es-lineal_files/figure-html/plotmandel-1.png&#34; alt=&#34;Curva de calibración Cu&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 5: Curva de calibración Cu
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;A simple vista se observa la no linealidad de la curva de calibración. Veamos que nos dice el Test de Mandel en la siguiente tabla ANOVA:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# d: corresponde al data frame de los datos de calibración

fit.lin &amp;lt;- lm(y ~ x, data = d) # Ajuste lineal.
fit.nolin &amp;lt;- lm(y ~ x + I(x^2), data = d) # Ajuste no lineal cuadrático

anova(fit.lin, fit.nolin)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;Analysis of Variance Table

Model 1: y ~ x
Model 2: y ~ x + I(x^2)
  Res.Df       RSS Df Sum of Sq      F    Pr(&amp;gt;F)    
1      9 0.0054816                                  
2      8 0.0000186  1  0.005463 2351.1 3.621e-11 ***
---
Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;En la tabla el valor &lt;span class=&#34;math inline&#34;&gt;\(F = 2351\)&lt;/span&gt; corresponde al &lt;span class=&#34;math inline&#34;&gt;\(F_{calculado}\)&lt;/span&gt; el cual es comparado internamente con el &lt;span class=&#34;math inline&#34;&gt;\(F_{tabla}\)&lt;/span&gt; entregando, finalmente, el &lt;em&gt;p-value&lt;/em&gt; &lt;span class=&#34;math inline&#34;&gt;\(Pr(&amp;gt;F) = 3.62e-11\)&lt;/span&gt;. La evidencia en contra de la hipótesis nula de linealidad es abrumadora.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;entonces-resumiendo-por-que-no-puedo-probar-linealidad-de-la-curva-de-calibracion&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Entonces, resumiendo ¿Por qué no puedo probar linealidad de la curva de calibración?&lt;/h1&gt;
&lt;p&gt;Porque la decisión está basada en pruebas estadísticas, las cuáles tienen algunas consideraciones para su correcta interpretación:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;Con estas pruebas estadísticas no se puede probar linealidad, lo que podemos concluir es que el modelo lineal es adecuado o razonable para modelar nuestros datos de calibración ¡nada más!.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Es imposible que en un sistema físico-químico complejo como una llama o plasma/detector (ICP-MS) exista una relación “perfectamente” lineal entre absorbancia (cuentas) y concentración. Lo que hicieron Lambert &amp;amp; Beer (o cualquier científico que proponga un modelo de la naturaleza) fue proponer una simplificación del sistema y representarlo mediante un modelo cuantitativo.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Existen muchos modelos que se podrían ajustar muy bien a nuestros datos de calibración, pero en estadística existe el principio de parsimonia:&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;En igualdad de condiciones, la explicación más sencilla suele ser la más probable&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;¿Por qué complicarnos la existencia con un modelo hiper-super-parabólico- tangencial si el modelo lineal es razonable y adecuado para nuestros propósitos de cuantificación? Pero ojo:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;“Everything should be made as simple as possible, but no simpler” – Albert Einstein&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Es aquí donde las pruebas estadísticas nos ayudan a decidir entre varios modelos plausibles.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;en-defensa-del-coeficiente-de-correlacion&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;En defensa del coeficiente de correlación&lt;/h1&gt;
&lt;p&gt;Es cierto, el &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; con “muchos” 9’s no es una prueba formal de linealidad… ¿quiere decir que el &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; no es importante en Química Analítica? Por supuesto que sí lo es. Anote:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;El coeficiente de correlación está íntimamente ligado con la incertidumbre de calibración. A mayor &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; menor es la incertidumbre de calibración.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Puede profundizar en este aspecto consultando en:&lt;/p&gt;
&lt;p&gt;Ellison, S.L.R. In defense of the correlation coefficient. &lt;em&gt;Accred Qual Assur (2006) 11: 146.&lt;/em&gt; &lt;a href=&#34;https://doi.org/10.1007/s00769-006-0087-y&#34; class=&#34;uri&#34;&gt;https://doi.org/10.1007/s00769-006-0087-y&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;por-ultimo-y-el-r2&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Por último… ¿y el &lt;span class=&#34;math inline&#34;&gt;\(r^2\)&lt;/span&gt;?&lt;/h1&gt;
&lt;p&gt;Ahhh, pero eso es otra cosa… hasta la próxima.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;bibliografia&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Bibliografía&lt;/h1&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;Lutz Brüggemann, Wolfgang Quapp, Rainer Wennrich &lt;strong&gt;Test for non-linearity concerning linear calibrated chemical measurements&lt;/strong&gt; (2006) &lt;em&gt;Accreditation and Quality Assurance Volume 11, Issue 12, pp 625–631&lt;/em&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;J. M. Andrade and M. P. Gómez-Carracedo &lt;strong&gt;Notes on the use of Mandel’s test to check for nonlinearity in laboratory calibrations&lt;/strong&gt; &lt;em&gt;Anal. Methods, 2013,5, 1145-1149&lt;/em&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>¿Cómo calcular la incertidumbre de una curva de calibración?</title>
      <link>https://www.analytical.cl/post/como-calcular-la-incertidumbre-de-una-curva-de-calibracion/</link>
      <pubDate>Mon, 14 Aug 2017 00:00:00 +0000</pubDate>
      
      <guid>https://www.analytical.cl/post/como-calcular-la-incertidumbre-de-una-curva-de-calibracion/</guid>
      <description>&lt;p&gt;Ok, este es el segundo post pero advierto que aún está en rodaje… esto del &lt;em&gt;copywriting&lt;/em&gt; no es nada fácil.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;¿Qué es y cómo estimar la incertidumbre de una curva de calibración?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;La incertidumbre de calibración, en adelante &lt;span class=&#34;math inline&#34;&gt;\(u(x_{0})\)&lt;/span&gt;, es aquella que se propaga cuando obtenemos la concentración de un mensurando al &lt;em&gt;interpolar&lt;/em&gt; una señal instrumental (por ejemplo, absorbancia o área cromatográfica) en una curva de calibración. Básicamente, esta incertidumbre sólo da cuenta del error aleatorio del instrumento y no incopora la incertidumbre de los calibrantes, al menos cuando se utiliza el modelo de calibración clásico:&lt;/p&gt;
&lt;span class=&#34;math display&#34; id=&#34;eq:lin&#34;&gt;\[\begin{equation}
  y = \beta_{0} + \beta_{1} x + \epsilon
    \tag{1}
\end{equation}\]&lt;/span&gt;
&lt;p&gt;donde &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt; es la respuesta instrumental, &lt;span class=&#34;math inline&#34;&gt;\(\beta_{0}\)&lt;/span&gt; es el intercepto, &lt;span class=&#34;math inline&#34;&gt;\(\beta_{1}\)&lt;/span&gt; es la pendiente y &lt;span class=&#34;math inline&#34;&gt;\(\epsilon\)&lt;/span&gt; es un error aleatorio Normal que tiene media &lt;span class=&#34;math inline&#34;&gt;\(\mu_{\epsilon} = 0\)&lt;/span&gt; y varianza &lt;span class=&#34;math inline&#34;&gt;\(\sigma_{y/x}^2\)&lt;/span&gt;. Note de la ecuación &lt;a href=&#34;#eq:lin&#34;&gt;(1)&lt;/a&gt; que lo único aleatorio es &lt;span class=&#34;math inline&#34;&gt;\(\epsilon\)&lt;/span&gt;, por lo tanto, el intercepto &lt;span class=&#34;math inline&#34;&gt;\(\beta_{0}\)&lt;/span&gt; y la pendiente &lt;span class=&#34;math inline&#34;&gt;\(\beta_{1}\)&lt;/span&gt; son &lt;em&gt;fijos&lt;/em&gt;. Lo que hacemos cuando aplicamos, por ejemplo, el método de los mínimos cuadrados es estimar estos parámetros y, en estadística, todas las estimaciones tienen un error asociado.&lt;/p&gt;
&lt;p&gt;A partir de la ecuación &lt;a href=&#34;#eq:lin&#34;&gt;(1)&lt;/a&gt; obtenemos la concentración de una muestra problema &lt;span class=&#34;math inline&#34;&gt;\(x_{0}\)&lt;/span&gt; cuya señal instrumental es &lt;span class=&#34;math inline&#34;&gt;\(y_{0}\)&lt;/span&gt;:&lt;/p&gt;
&lt;span class=&#34;math display&#34; id=&#34;eq:x0&#34;&gt;\[\begin{equation}
  x_{0} = \frac{y_{0} - \beta_{0}}{\beta_{1}}
    \tag{2}
\end{equation}\]&lt;/span&gt;
&lt;p&gt;Si aplicáramos la guía GUM para obtener la incertidumbre estándar de calibración &lt;span class=&#34;math inline&#34;&gt;\(u(x_{0})\)&lt;/span&gt; sería bastante latoso-engorroso, pues hay unas covarianzas no muy amistosas entre pendiente e intercepto. Afortunadamente &lt;span class=&#34;math inline&#34;&gt;\(u(x_{0})\)&lt;/span&gt; puede aproximarse muy bien a través de la ecuación &lt;a href=&#34;#eq:ux0&#34;&gt;(3)&lt;/a&gt;:&lt;/p&gt;
&lt;span class=&#34;math display&#34; id=&#34;eq:ux0&#34;&gt;\[\begin{equation}
  u(x_{0}) = \frac{\sigma_{y/x}}{\beta_{1}}
  \sqrt{\frac{1}{n} + \frac{1}{m_{0}} + \frac{(x_{0} - \overline{x})^2}
  {\sum_{i}^{n} (x_{i} - \overline{x})^2}}
    \tag{3}
\end{equation}\]&lt;/span&gt;
&lt;p&gt;Vamos viendo dijo el ciego:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(\sigma_{y/x}\)&lt;/span&gt; es la desviación estándar del error aleatorio &lt;span class=&#34;math inline&#34;&gt;\(\epsilon\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; es el número de calibrantes independientes (esto da para otro post)&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(m_{0}\)&lt;/span&gt; es el número de replicado independientes de la muestra problema&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(\overline{x}\)&lt;/span&gt; es el promedio de la concentraciones de los calibrantes&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Esta incertidumbre se puede observar en la figura &lt;a href=&#34;#fig:banda&#34;&gt;1&lt;/a&gt;, la cual fue obtenida mediante simulación en lenguaje &lt;code&gt;R&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;set.seed(123)
x &amp;lt;- 1:10
y &amp;lt;- 2 + 5*x + 10*rnorm(length(x), 0, 1)
d &amp;lt;- data.frame(x, y)

library(ggplot2)

ggplot(d, aes(x = x, y = y)) +
  geom_smooth(method = &amp;#39;lm&amp;#39;) &lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:banda&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/2017-08-13-como-calcular-la-incertidumbre-de-una-curva-de-calibración_files/figure-html/banda-1.png&#34; alt=&#34;Incertidumbre de calibración&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 1: Incertidumbre de calibración
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;¿Dónde se obtiene la menor incertidumbre de calibración? … ¡Correcto!&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;En el centro de la curva se minimiza la incertidumbre de calibración&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Si obervamos la ecuación &lt;a href=&#34;#eq:ux0&#34;&gt;(3)&lt;/a&gt; podemos minimizar &lt;span class=&#34;math inline&#34;&gt;\(u(x_{0})\)&lt;/span&gt;:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Aumentando &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; el número de calibrantes.&lt;/li&gt;
&lt;li&gt;Aumentando &lt;span class=&#34;math inline&#34;&gt;\(m_{0}\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;Diseñando la curva de calibración de modo que &lt;span class=&#34;math inline&#34;&gt;\(x_{0} = \bar{x}\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;Aunque no tan “evidente”, maximizando &lt;span class=&#34;math inline&#34;&gt;\(\sum_{i}^{n} (x_{i} - \overline{x})^2\)&lt;/span&gt;, es decir, utilizando todo el rango lineal (Nota mental: otro post)&lt;/li&gt;
&lt;/ol&gt;
&lt;div id=&#34;aplicacion-a-un-caso-real&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Aplicación a un caso “real”&lt;/h1&gt;
&lt;p&gt;La tabla &lt;a href=&#34;#tab:tabla&#34;&gt;1&lt;/a&gt; muestra los datos de una curva de calibración para la determinación de cobre en mineral por AAS, la figura &lt;a href=&#34;#fig:cal&#34;&gt;2&lt;/a&gt; describe el gráfico de calibración:&lt;/p&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
  &lt;p&gt;Alguien capo en HTML/CSS que me ayude a poner tabla enfrentada con figura en 2 columnas por favor… y que Dios se lo pague.&lt;/p&gt;

&lt;/div&gt;

&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
&lt;table class=&#34;table&#34; style=&#34;width: auto !important; text-align: right;&#34;&gt;
&lt;caption&gt;
&lt;span id=&#34;tab:tabla&#34;&gt;Table 1: &lt;/span&gt;Curva de Calibración Cu
&lt;/caption&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
Cu [ppm]
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
UA
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
1
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.0344
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
2
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.0777
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
3
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.1356
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
4
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.1607
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
5
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.2013
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
6
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.2572
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
7
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.2846
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
8
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.3073
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
9
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.3531
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
10
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.3955
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:cal&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/2017-08-13-como-calcular-la-incertidumbre-de-una-curva-de-calibración_files/figure-html/cal-1.png&#34; alt=&#34;Curva de calibración&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 2: Curva de calibración
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Ok, hay varias formas de implementar los cálculos de incertidumbre de calibración de la ecuación &lt;a href=&#34;#eq:ux0&#34;&gt;(3)&lt;/a&gt;. Podríamos utilizar Excel para obtener cada uno de los términos, pero eso lo ilustraremos en otro post. En esta oportunidad utilizaremos el software &lt;code&gt;R&lt;/code&gt;. Este software posee varias librerías o packages especializados en el cálculo de incertidumbre en química analítica, por ejemplo: &lt;code&gt;metRology&lt;/code&gt; y &lt;code&gt;chemCal&lt;/code&gt;. En este post utilizaremos el segundo, pues entrega en forma directa el cálculo de la incertidumbre de calibración:&lt;/p&gt;
&lt;div class=&#34;alert alert-warning&#34;&gt;
  &lt;p&gt;Si no tienes instalado el package &lt;code&gt;chemCal&lt;/code&gt; utiliza el comando &lt;code&gt;install.packages(&amp;lsquo;chemCal&amp;rsquo;)&lt;/code&gt;. Una vez instalado procede con el siguiente código.&lt;/p&gt;

&lt;/div&gt;

&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Creación del modelo de calibración lineal, al que llamaremos fit.lin 
# (En otro post se profundizará sobre otros modelos de calibración en R)

fit.lin &amp;lt;- lm(y ~ x, data = d)

# Simular un valor de respuesta de la muestra problema, es decir, y0.
# Sólo por conveniencia simularemos que y0 = 0.200 UA, es decir, más o menos
# en el centro de la curva:

y0 &amp;lt;- 0.200

# Cargar la librería chemCal con el comando &amp;#39;library&amp;#39;:

library(chemCal)

# Calcular la concentración de la muestra problema, x0, a partir de su señal
# instrumental y0, junto con la incertidumbre estándar de calibración u(x0) e
# incertidumbre expandida U(x0) con un 95% de confianza:

inverse.predict(fit.lin, newdata = y0)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;$Prediction
[1] 4.970492

$`Standard Error`
[1] 0.2618792

$Confidence
[1] 0.6038946

$`Confidence Limits`
[1] 4.366598 5.574387&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Bien, interpretemos la salida:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;$Prediction&lt;/code&gt; es la concentración de la muestra problema en [ppm]&lt;/li&gt;
&lt;li&gt;&lt;code&gt;$Standard Error&lt;/code&gt; es la incertidumbre estándar de calibración, es decir, la que se obtiene de la ecuación &lt;a href=&#34;#eq:ux0&#34;&gt;(3)&lt;/a&gt; expresada, obviamente, en las mismas unidades que los calibrantes [ppm].&lt;/li&gt;
&lt;li&gt;&lt;code&gt;$Confidence&lt;/code&gt; es la incertidumbre expandida de calibración &lt;span class=&#34;math inline&#34;&gt;\(U(x0)\)&lt;/span&gt;, es decir, &lt;span class=&#34;math inline&#34;&gt;\(U(x0) = k\cdot u(x0)\)&lt;/span&gt; donde &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; es el factor de cobertura con el cual se obtiene un intervalo de incertidumbre con cierta confianza (habitualmente 95%). Más de esto en otro post.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;$Confidence Limits&lt;/code&gt; es simplemente &lt;span class=&#34;math inline&#34;&gt;\(x0 \pm U(x0)\)&lt;/span&gt;, es decir, &lt;span class=&#34;math inline&#34;&gt;\(5 \pm 0.6\)&lt;/span&gt; ppm (ojo con las cifras significativas… ahí va otro post).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Algunas consideraciones importantes:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;Esta incertidumbre de calibración &lt;span class=&#34;math inline&#34;&gt;\(u(x0)\)&lt;/span&gt; NO incorpora la incertidumbre de los calibrantes, sólo es un reflejo del error aleatorio instrumental. Punto. Es decir, asume que los calibrantes no tienen incertidumbre… lo cual todos los químicos sabemos que es ¡Farso, farso!&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Si Ud. requiere incorporar también la incertidumbre de los calibrantes, debe utilizar otro modelo lineal de calibración denominado: modelo lineal con error en ambos ejes (otro post).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Ya que esta incertidumbre sólo refleja el componente aleatorio de la calibración, no están incorporados los errores sistemáticos de la preparación de estándares: error en el aforo, no considerar la pureza del reactivo, etc. (Nota mental: otro post… ¿cuántos van?).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Si, además, el método analítico incluye pesada de la muestra, digestión o extracción, aforo final, factor de dilución, etc. Ud.debe, mediante los mandamientos de la guía GUM, combinar todas estas fuentes de incertidumbre con la de calibración &lt;span class=&#34;math inline&#34;&gt;\(u(x0)\)&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;En el fondo, como se asume que los calibrantes no tienen incertidumbre, &lt;span class=&#34;math inline&#34;&gt;\(u(x0)\)&lt;/span&gt; reflejaría el comportamiento aleatorio del instrumento cuando se lee la curva “muchas” veces, siempre con los mismos calibrantes. En cada oportunidad, se obtendría una pendiente e intercepto distintos (debido a al error aleatorio &lt;span class=&#34;math inline&#34;&gt;\(\epsilon\)&lt;/span&gt;), por lo tanto, también una concentración &lt;span class=&#34;math inline&#34;&gt;\(x0\)&lt;/span&gt; distinta cada vez.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Bueno espero que este post, en rodaje áun, haya sido de su agrado. Como siempre, siéntase libre de criticarlo. Nos vemos.&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Primer Post, perdone lo poco</title>
      <link>https://www.analytical.cl/post/primer-post/</link>
      <pubDate>Sun, 13 Aug 2017 00:00:00 +0000</pubDate>
      
      <guid>https://www.analytical.cl/post/primer-post/</guid>
      <description>&lt;script src=&#34;https://www.analytical.cl/rmarkdown-libs/htmlwidgets/htmlwidgets.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;https://www.analytical.cl/rmarkdown-libs/jquery/jquery.min.js&#34;&gt;&lt;/script&gt;
&lt;link href=&#34;https://www.analytical.cl/rmarkdown-libs/leaflet/leaflet.css&#34; rel=&#34;stylesheet&#34; /&gt;
&lt;script src=&#34;https://www.analytical.cl/rmarkdown-libs/leaflet/leaflet.js&#34;&gt;&lt;/script&gt;
&lt;link href=&#34;https://www.analytical.cl/rmarkdown-libs/leafletfix/leafletfix.css&#34; rel=&#34;stylesheet&#34; /&gt;
&lt;link href=&#34;https://www.analytical.cl/rmarkdown-libs/leaflet-label/leaflet.label.css&#34; rel=&#34;stylesheet&#34; /&gt;
&lt;script src=&#34;https://www.analytical.cl/rmarkdown-libs/leaflet-label/leaflet.label.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;https://www.analytical.cl/rmarkdown-libs/Proj4Leaflet/proj4-compressed.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;https://www.analytical.cl/rmarkdown-libs/Proj4Leaflet/proj4leaflet.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;https://www.analytical.cl/rmarkdown-libs/leaflet-binding/leaflet.js&#34;&gt;&lt;/script&gt;


&lt;p&gt;Este es el primer post de esta página. Estoy utilizando &lt;code&gt;blogdown&lt;/code&gt; para generar los post, el cual permite incorporar código en &lt;code&gt;R&lt;/code&gt; y &lt;span class=&#34;math inline&#34;&gt;\(\LaTeX\)&lt;/span&gt; en el mismo documento.&lt;/p&gt;
&lt;p&gt;Probando &lt;span class=&#34;math inline&#34;&gt;\(\LaTeX\)&lt;/span&gt;:&lt;/p&gt;
&lt;span class=&#34;math display&#34;&gt;\[
\mu = \int xf(x)dx
\]&lt;/span&gt;
&lt;span class=&#34;math display&#34; id=&#34;eq:mc2&#34;&gt;\[\begin{equation}
  E = mc^{2}
    \tag{1}
\end{equation}\]&lt;/span&gt;
&lt;p&gt;La ecuación &lt;a href=&#34;#eq:mc2&#34;&gt;(1)&lt;/a&gt; es muy importante.&lt;/p&gt;
&lt;p&gt;Probando R:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(ggplot2)

ggplot(mtcars, aes(x = wt, y = mpg)) +
  geom_point(pch = 19, col = &amp;#39;red&amp;#39;) +
  geom_smooth(method = &amp;#39;lm&amp;#39;) +
  theme_bw()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://www.analytical.cl/post/2017-08-13-primer-post_files/figure-html/unnamed-chunk-1-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Todos los modelos son erróneos, pero algunos son útiles (&lt;strong&gt;no me acuerdo quién dijo esto&lt;/strong&gt;)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Probando el package &lt;code&gt;leaflet&lt;/code&gt;. En la figura &lt;a href=&#34;#fig:bv&#34;&gt;1&lt;/a&gt; está ubicada mi fuente laboral.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(leaflet)

m &amp;lt;- leaflet() %&amp;gt;%
  addTiles() %&amp;gt;%  
  addMarkers(lng = -70.613644, 
             lat = -33.478783, 
             popup = &amp;#39;Aquí trabajo&amp;#39;)
m  &lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:bv&#34;&gt;&lt;/span&gt;
&lt;div id=&#34;htmlwidget-1&#34; style=&#34;width:672px;height:480px;&#34; class=&#34;leaflet html-widget&#34;&gt;&lt;/div&gt;
&lt;script type=&#34;application/json&#34; data-for=&#34;htmlwidget-1&#34;&gt;{&#34;x&#34;:{&#34;options&#34;:{&#34;crs&#34;:{&#34;crsClass&#34;:&#34;L.CRS.EPSG3857&#34;,&#34;code&#34;:null,&#34;proj4def&#34;:null,&#34;projectedBounds&#34;:null,&#34;options&#34;:{}}},&#34;calls&#34;:[{&#34;method&#34;:&#34;addTiles&#34;,&#34;args&#34;:[&#34;//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png&#34;,null,null,{&#34;minZoom&#34;:0,&#34;maxZoom&#34;:18,&#34;maxNativeZoom&#34;:null,&#34;tileSize&#34;:256,&#34;subdomains&#34;:&#34;abc&#34;,&#34;errorTileUrl&#34;:&#34;&#34;,&#34;tms&#34;:false,&#34;continuousWorld&#34;:false,&#34;noWrap&#34;:false,&#34;zoomOffset&#34;:0,&#34;zoomReverse&#34;:false,&#34;opacity&#34;:1,&#34;zIndex&#34;:null,&#34;unloadInvisibleTiles&#34;:null,&#34;updateWhenIdle&#34;:null,&#34;detectRetina&#34;:false,&#34;reuseTiles&#34;:false,&#34;attribution&#34;:&#34;&amp;copy; &lt;a href=\&#34;http://openstreetmap.org\&#34;&gt;OpenStreetMap&lt;\/a&gt; contributors, &lt;a href=\&#34;http://creativecommons.org/licenses/by-sa/2.0/\&#34;&gt;CC-BY-SA&lt;\/a&gt;&#34;}]},{&#34;method&#34;:&#34;addMarkers&#34;,&#34;args&#34;:[-33.478783,-70.613644,null,null,null,{&#34;clickable&#34;:true,&#34;draggable&#34;:false,&#34;keyboard&#34;:true,&#34;title&#34;:&#34;&#34;,&#34;alt&#34;:&#34;&#34;,&#34;zIndexOffset&#34;:0,&#34;opacity&#34;:1,&#34;riseOnHover&#34;:false,&#34;riseOffset&#34;:250},&#34;Aquí trabajo&#34;,null,null,null,null,null,null]}],&#34;limits&#34;:{&#34;lat&#34;:[-33.478783,-33.478783],&#34;lng&#34;:[-70.613644,-70.613644]}},&#34;evals&#34;:[],&#34;jsHooks&#34;:[]}&lt;/script&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 1: Ubicación de Bureau Veritas
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Probando tablas:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;knitr::kable(head(mtcars))&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;mpg&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;cyl&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;disp&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;hp&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;drat&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;wt&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;qsec&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;vs&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;am&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;gear&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;carb&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;Mazda RX4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;21.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;160&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;110&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.90&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.620&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16.46&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;Mazda RX4 Wag&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;21.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;160&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;110&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.90&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.875&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;17.02&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;Datsun 710&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;22.8&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;108&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;93&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.85&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.320&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;18.61&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;Hornet 4 Drive&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;21.4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;258&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;110&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.08&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.215&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;19.44&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;Hornet Sportabout&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;18.7&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;360&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;175&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.15&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.440&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;17.02&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;Valiant&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;18.1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;225&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;105&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.76&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.460&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;20.22&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Ok t’amos listos.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Análisis Geoespacial de Zonas de Producción de Mieles</title>
      <link>https://www.analytical.cl/project/indice_mieles_chile/</link>
      <pubDate>Thu, 27 Jul 2017 00:00:00 +0000</pubDate>
      
      <guid>https://www.analytical.cl/project/indice_mieles_chile/</guid>
      <description>&lt;p&gt;Zonas idóneas para la apicultura
&lt;img src=&#34;static/img/indice.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Tutorial Rstudio&#43;knitr: Reportería automática con R</title>
      <link>https://www.analytical.cl/talk/example-talk/</link>
      <pubDate>Wed, 14 May 2014 19:00:00 +0000</pubDate>
      
      <guid>https://www.analytical.cl/talk/example-talk/</guid>
      <description>
&lt;div style=&#34;position: relative; padding-bottom: 56.25%; padding-top: 30px; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;//www.youtube.com/embed/4oV2ncCN_aQ?&#34;
  style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%;&#34; allowfullscreen frameborder=&#34;0&#34; title=&#34;YouTube Video&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;

&lt;p&gt;Embed your slides or video here using &lt;a href=&#34;https://gcushen.github.io/hugo-academic-demo/post/writing-markdown-latex/&#34; target=&#34;_blank&#34;&gt;shortcodes&lt;/a&gt;. Further details can easily be added using &lt;em&gt;Markdown&lt;/em&gt; and $\rm \LaTeX$ math code.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Establecimiento de la trazabilidad y estimación de incertidumbre en Metrología Química</title>
      <link>https://www.analytical.cl/talk/inn/</link>
      <pubDate>Thu, 12 Jul 2012 12:00:00 +0000</pubDate>
      
      <guid>https://www.analytical.cl/talk/inn/</guid>
      <description>
&lt;div style=&#34;position: relative; padding-bottom: 56.25%; padding-top: 30px; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;//www.youtube.com/embed/4oV2ncCN_aQ?&#34;
  style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%;&#34; allowfullscreen frameborder=&#34;0&#34; title=&#34;YouTube Video&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;

&lt;p&gt;Embed your slides or video here using &lt;a href=&#34;https://gcushen.github.io/hugo-academic-demo/post/writing-markdown-latex/&#34; target=&#34;_blank&#34;&gt;shortcodes&lt;/a&gt;. Further details can easily be added using &lt;em&gt;Markdown&lt;/em&gt; and $\rm \LaTeX$ math code.&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
